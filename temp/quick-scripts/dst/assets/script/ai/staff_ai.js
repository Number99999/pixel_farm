
                (function() {
                    var nodeEnv = typeof require !== 'undefined' && typeof process !== 'undefined';
                    var __module = nodeEnv ? module : {exports:{}};
                    var __filename = 'preview-scripts/assets/script/ai/staff_ai.js';
                    var __require = nodeEnv ? function (request) {
                        return cc.require(request);
                    } : function (request) {
                        return __quick_compile_project__.require(request, __filename);
                    };
                    function __define (exports, require, module) {
                        if (!nodeEnv) {__quick_compile_project__.registerModule(__filename, module);}"use strict";
cc._RF.push(module, 'b811fwDSLVAXr6L4c6nddw8', 'staff_ai');
// script/ai/staff_ai.js

"use strict";

var user_data = require("user_data");

var config = require("config");

cc.Class({
  "extends": cc.Component,
  properties: {
    player_node: cc.Node,
    pupple_node: cc.Node,
    staff_node: cc.Node
  },
  // LIFE-CYCLE CALLBACKS:
  // 每隔几秒改变移动方向
  change_movement_direction: function change_movement_direction() {
    var callback = function callback() {
      this.stop_move = false;

      if (this.work_state == "rest") {
        var num = Math.floor(Math.random() * this.rest_direction.length - 1) + 1;

        if (num < 0) {
          num = 0;
        }

        ;
        this.movement_direction = this.rest_direction[num];
        this.anim_select();
      } else {
        var num = Math.floor(Math.random() * this.all_direction.length - 1) + 1;

        if (num < 0) {
          num = 0;
        }

        ;
        this.movement_direction = this.all_direction[num];
        this.anim_select();
      }

      ;
    };

    this.schedule(callback, Math.random() * 3 + 2);
  },
  //anim select
  anim_select: function anim_select() {
    var anim = this.player_node.getComponent(cc.Animation);
    var anim_clips = anim.getClips(); //获取动画剪辑

    switch (this.movement_direction) {
      case "z_idle":
        anim.play(anim_clips[0].name);
        break;

      case "c_idle":
        anim.play(anim_clips[1].name);
        break;

      case "c_run_l":
        this.node.scaleX = 1;
        anim.play(anim_clips[2].name);
        break;

      case "c_run_r":
        this.node.scaleX = -1;
        anim.play(anim_clips[2].name);
        break;
    }

    ;
  },
  //随机某个方向移动
  ai_move: function ai_move(dt) {
    //dt游戏时间
    //得到每帧的速度
    var s = this.move_speed * dt; //

    if (this.node.x <= -150 && this.stop_move == false) {
      this.stop_move = true;
      this.movement_direction = "c_run_r";
      this.anim_select();
    }

    if (this.node.x >= 130 && this.stop_move == false) {
      this.stop_move = true;
      this.movement_direction = "c_run_l";
      this.anim_select();
    } //几种不同的移动策略


    switch (this.movement_direction) {
      case "z_idle":
        s = 0;
        break;

      case "c_idle":
        s = 0;
        break;

      case "c_run_l":
        this.node.x -= s;
        break;

      case "c_run_r":
        this.node.x += s;
        break;
    }

    ;
  },
  //auto work
  auto_work: function auto_work() {
    var land_js = this.node.parent.getComponent("land");
    var land_index = land_js.land_index;

    var callback = function callback() {
      //工作状态工作
      if (this.work_state == "work") {
        switch (user_data.user_data.land[land_index].land_state) {
          case "wait_cut":
            land_js.cut();
            break;

          case "grow":
            if (user_data.user_data.land[land_index].water_num <= 0) {
              land_js.water_charge();
            }

            ;
            break;

          default:
            return;
        }

        ; //end switch
        // cc.log("工作中");
      } else {
        return;
      }

      ; //end if
    };

    this.schedule(callback, 0.5, cc.macro.REPEAT_FOREVER);
  },
  //工作定时器
  work_schedule: function work_schedule() {
    this.work_state = "work";
    var work_time = config.staff[this.staff_index].work_time + user_data.user_data.skill["labor_contract"];

    var callback = function callback() {
      work_time--;

      if (work_time <= 0) {
        this.unschedule(callback); //停止工作计时器
        // cc.log(this.staff_index, "号休息");

        var now_time = new Date().getTime() / 1000;
        user_data.user_data.staff[this.staff_index].over_time = now_time;
        this.rest_schedule();
      }

      ; //end if
    }; //end callback


    this.schedule(callback, 1, cc.macro.REPEAT_FOREVER);
  },
  //休息时小人被点击
  on_staff_node_touch: function on_staff_node_touch() {
    this.sound_control.play_sound_effect("button_click");
    this.game_scene_js.create_rest_ui(this.game_scene_js.node, this.staff_index);
  },
  //休息定时器
  rest_schedule: function rest_schedule() {
    this.work_state = "rest";

    var callback = function callback() {
      if (this.work_state == "rest") {
        //启动监听事件
        this.staff_node.on("touchstart", this.on_staff_node_touch, this);
        this.pupple_node.on("touchstart", this.on_staff_node_touch, this);
        var now_time = new Date().getTime() / 1000;
        var over_time = user_data.user_data.staff[this.staff_index].over_time;
        var rest_time = config.staff[this.staff_index].rest_time - user_data.user_data.trader.recipes; //休息时间最小值为0

        if (rest_time <= 0) {
          rest_time = 0;
        }

        ; //没有工作过就直接工作

        if (over_time == 0) {
          this.work_schedule();
          this.pupple_node.active = false;
          this.unschedule(callback);
          return;
        } else {
          if (now_time - over_time >= rest_time) {
            //休息结束
            // cc.log(this.staff_index, "开始工作");
            this.pupple_node.active = false;
            this.unschedule(callback);
            this.work_schedule();
            this.staff_node.off("touchstart", this.on_staff_node_touch, this);
            this.pupple_node.on("touchstart", this.on_staff_node_touch, this);
          } else {
            // cc.log("休息");
            this.work_state = "rest";
            this.pupple_node.active = true;
          }

          ; //end if
        }

        ; //end if
      } else {
        this.unschedule(callback);
      }

      ; // end if
    };

    this.schedule(callback, 0.5, cc.macro.REPEAT_FOREVER);
  },
  ini_node: function ini_node(staff_index) {
    this.game_scene_js = cc.find("UI_ROOT").getComponent("game_scene");
    ;
    this.sound_control = cc.find("sound_control").getComponent("sound_control");
    this.adsManager_js = cc.find("UI_ROOT").getComponent("AdsManager");
    this.staff_index = staff_index;
    this.all_direction = ["z_idle", "c_idle", "c_run_l", "c_run_r"];
    this.rest_direction = ["z_idle", "c_idle"];
    this.movement_direction = "z_idle"; //小人的移动速度

    this.move_speed = 30; //停止移动，边缘时触发

    this.stop_move = false;
    this.staff_state = null;
    this.work_state = null;
    this.node.setPosition(0, -140);
  },
  onLoad: function onLoad() {},
  start: function start() {
    this.change_movement_direction();
    this.anim_select();
    this.rest_schedule();
    this.auto_work();
  },
  update: function update(dt) {
    this.ai_move(dt);
  }
});

cc._RF.pop();
                    }
                    if (nodeEnv) {
                        __define(__module.exports, __require, __module);
                    }
                    else {
                        __quick_compile_project__.registerModuleFunc(__filename, function () {
                            __define(__module.exports, __require, __module);
                        });
                    }
                })();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFzc2V0c1xcc2NyaXB0XFxhaVxcc3RhZmZfYWkuanMiXSwibmFtZXMiOlsidXNlcl9kYXRhIiwicmVxdWlyZSIsImNvbmZpZyIsImNjIiwiQ2xhc3MiLCJDb21wb25lbnQiLCJwcm9wZXJ0aWVzIiwicGxheWVyX25vZGUiLCJOb2RlIiwicHVwcGxlX25vZGUiLCJzdGFmZl9ub2RlIiwiY2hhbmdlX21vdmVtZW50X2RpcmVjdGlvbiIsImNhbGxiYWNrIiwic3RvcF9tb3ZlIiwid29ya19zdGF0ZSIsIm51bSIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsInJlc3RfZGlyZWN0aW9uIiwibGVuZ3RoIiwibW92ZW1lbnRfZGlyZWN0aW9uIiwiYW5pbV9zZWxlY3QiLCJhbGxfZGlyZWN0aW9uIiwic2NoZWR1bGUiLCJhbmltIiwiZ2V0Q29tcG9uZW50IiwiQW5pbWF0aW9uIiwiYW5pbV9jbGlwcyIsImdldENsaXBzIiwicGxheSIsIm5hbWUiLCJub2RlIiwic2NhbGVYIiwiYWlfbW92ZSIsImR0IiwicyIsIm1vdmVfc3BlZWQiLCJ4IiwiYXV0b193b3JrIiwibGFuZF9qcyIsInBhcmVudCIsImxhbmRfaW5kZXgiLCJsYW5kIiwibGFuZF9zdGF0ZSIsImN1dCIsIndhdGVyX251bSIsIndhdGVyX2NoYXJnZSIsIm1hY3JvIiwiUkVQRUFUX0ZPUkVWRVIiLCJ3b3JrX3NjaGVkdWxlIiwid29ya190aW1lIiwic3RhZmYiLCJzdGFmZl9pbmRleCIsInNraWxsIiwidW5zY2hlZHVsZSIsIm5vd190aW1lIiwiRGF0ZSIsImdldFRpbWUiLCJvdmVyX3RpbWUiLCJyZXN0X3NjaGVkdWxlIiwib25fc3RhZmZfbm9kZV90b3VjaCIsInNvdW5kX2NvbnRyb2wiLCJwbGF5X3NvdW5kX2VmZmVjdCIsImdhbWVfc2NlbmVfanMiLCJjcmVhdGVfcmVzdF91aSIsIm9uIiwicmVzdF90aW1lIiwidHJhZGVyIiwicmVjaXBlcyIsImFjdGl2ZSIsIm9mZiIsImluaV9ub2RlIiwiZmluZCIsImFkc01hbmFnZXJfanMiLCJzdGFmZl9zdGF0ZSIsInNldFBvc2l0aW9uIiwib25Mb2FkIiwic3RhcnQiLCJ1cGRhdGUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsSUFBSUEsU0FBUyxHQUFHQyxPQUFPLENBQUMsV0FBRCxDQUF2Qjs7QUFDQSxJQUFJQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyxRQUFELENBQXBCOztBQUNBRSxFQUFFLENBQUNDLEtBQUgsQ0FBUztBQUNMLGFBQVNELEVBQUUsQ0FBQ0UsU0FEUDtBQUdMQyxFQUFBQSxVQUFVLEVBQUU7QUFDUkMsSUFBQUEsV0FBVyxFQUFFSixFQUFFLENBQUNLLElBRFI7QUFFUkMsSUFBQUEsV0FBVyxFQUFFTixFQUFFLENBQUNLLElBRlI7QUFHUkUsSUFBQUEsVUFBVSxFQUFFUCxFQUFFLENBQUNLO0FBSFAsR0FIUDtBQVNMO0FBQ0E7QUFDQUcsRUFBQUEseUJBQXlCLEVBQUUscUNBQVk7QUFDbkMsUUFBSUMsUUFBUSxHQUFHLFNBQVhBLFFBQVcsR0FBWTtBQUN2QixXQUFLQyxTQUFMLEdBQWlCLEtBQWpCOztBQUNBLFVBQUksS0FBS0MsVUFBTCxJQUFtQixNQUF2QixFQUErQjtBQUMzQixZQUFJQyxHQUFHLEdBQUdDLElBQUksQ0FBQ0MsS0FBTCxDQUFXRCxJQUFJLENBQUNFLE1BQUwsS0FBZ0IsS0FBS0MsY0FBTCxDQUFvQkMsTUFBcEMsR0FBNkMsQ0FBeEQsSUFBNkQsQ0FBdkU7O0FBQ0EsWUFBSUwsR0FBRyxHQUFHLENBQVYsRUFBYTtBQUNUQSxVQUFBQSxHQUFHLEdBQUcsQ0FBTjtBQUNIOztBQUFBO0FBQ0QsYUFBS00sa0JBQUwsR0FBMEIsS0FBS0YsY0FBTCxDQUFvQkosR0FBcEIsQ0FBMUI7QUFDQSxhQUFLTyxXQUFMO0FBQ0gsT0FQRCxNQU9PO0FBQ0gsWUFBSVAsR0FBRyxHQUFHQyxJQUFJLENBQUNDLEtBQUwsQ0FBV0QsSUFBSSxDQUFDRSxNQUFMLEtBQWdCLEtBQUtLLGFBQUwsQ0FBbUJILE1BQW5DLEdBQTRDLENB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SDtBQXpOSSxDQUFUIiwic291cmNlUm9vdCI6Ii8iLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgdXNlcl9kYXRhID0gcmVxdWlyZShcInVzZXJfZGF0YVwiKTtcbnZhciBjb25maWcgPSByZXF1aXJlKFwiY29uZmlnXCIpO1xuY2MuQ2xhc3Moe1xuICAgIGV4dGVuZHM6IGNjLkNvbXBvbmVudCxcblxuICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgcGxheWVyX25vZGU6IGNjLk5vZGUsXG4gICAgICAgIHB1cHBsZV9ub2RlOiBjYy5Ob2RlLFxuICAgICAgICBzdGFmZl9ub2RlOiBjYy5Ob2RlLFxuICAgIH0sXG5cbiAgICAvLyBMSUZFLUNZQ0xFIENBTExCQUNLUzpcbiAgICAvLyDmr4/pmpTlh6Dnp5LmlLnlj5jnp7vliqjmlrnlkJFcbiAgICBjaGFuZ2VfbW92ZW1lbnRfZGlyZWN0aW9uOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjYWxsYmFjayA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHRoaXMuc3RvcF9tb3ZlID0gZmFsc2U7XG4gICAgICAgICAgICBpZiAodGhpcy53b3JrX3N0YXRlID09IFwicmVzdFwiKSB7XG4gICAgICAgICAgICAgICAgdmFyIG51bSA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMucmVzdF9kaXJlY3Rpb24ubGVuZ3RoIC0gMSkgKyAxO1xuICAgICAgICAgICAgICAgIGlmIChudW0gPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG51bSA9IDA7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVtZW50X2RpcmVjdGlvbiA9IHRoaXMucmVzdF9kaXJlY3Rpb25bbnVtXTtcbiAgICAgICAgICAgICAgICB0aGlzLmFuaW1fc2VsZWN0KCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHZhciBudW0gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiB0aGlzLmFsbF9kaXJlY3Rpb24ubGVuZ3RoIC0gMSkgKyAxO1xuICAgICAgICAgICAgICAgIGlmIChudW0gPCAwKSB7XG4gICAgICAgICAgICAgICAgICAgIG51bSA9IDA7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLm1vdmVtZW50X2RpcmVjdGlvbiA9IHRoaXMuYWxsX2RpcmVjdGlvbltudW1dO1xuICAgICAgICAgICAgICAgIHRoaXMuYW5pbV9zZWxlY3QoKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuc2NoZWR1bGUoY2FsbGJhY2ssIE1hdGgucmFuZG9tKCkgKiAzICsgMik7XG4gICAgfSxcbiAgICAvL2FuaW0gc2VsZWN0XG4gICAgYW5pbV9zZWxlY3Q6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGFuaW0gPSB0aGlzLnBsYXllcl9ub2RlLmdldENvbXBvbmVudChjYy5BbmltYXRpb24pO1xuICAgICAgICB2YXIgYW5pbV9jbGlwcyA9IGFuaW0uZ2V0Q2xpcHMoKTsvL+iOt+WPluWKqOeUu+WJqui+kVxuICAgICAgICBzd2l0Y2ggKHRoaXMubW92ZW1lbnRfZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIFwiel9pZGxlXCI6XG4gICAgICAgICAgICAgICAgYW5pbS5wbGF5KGFuaW1fY2xpcHNbMF0ubmFtZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY19pZGxlXCI6XG4gICAgICAgICAgICAgICAgYW5pbS5wbGF5KGFuaW1fY2xpcHNbMV0ubmFtZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY19ydW5fbFwiOlxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS5zY2FsZVggPSAxO1xuICAgICAgICAgICAgICAgIGFuaW0ucGxheShhbmltX2NsaXBzWzJdLm5hbWUpO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSBcImNfcnVuX3JcIjpcbiAgICAgICAgICAgICAgICB0aGlzLm5vZGUuc2NhbGVYID0gLTE7XG4gICAgICAgICAgICAgICAgYW5pbS5wbGF5KGFuaW1fY2xpcHNbMl0ubmFtZSk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH07XG4gICAgfSxcbiAgICAvL+maj+acuuafkOS4quaWueWQkeenu+WKqFxuICAgIGFpX21vdmU6IGZ1bmN0aW9uIChkdCkgeyAvL2R05ri45oiP5pe26Ze0XG4gICAgICAgIC8v5b6X5Yiw5q+P5bin55qE6YCf5bqmXG4gICAgICAgIHZhciBzID0gdGhpcy5tb3ZlX3NwZWVkICogZHQ7XG4gICAgICAgIC8vXG4gICAgICAgIGlmICh0aGlzLm5vZGUueCA8PSAtMTUwICYmIHRoaXMuc3RvcF9tb3ZlID09IGZhbHNlKSB7XG4gICAgICAgICAgICB0aGlzLnN0b3BfbW92ZSA9IHRydWU7XG4gICAgICAgICAgICB0aGlzLm1vdmVtZW50X2RpcmVjdGlvbiA9IFwiY19ydW5fclwiO1xuICAgICAgICAgICAgdGhpcy5hbmltX3NlbGVjdCgpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLm5vZGUueCA+PSAxMzAgJiYgdGhpcy5zdG9wX21vdmUgPT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHRoaXMuc3RvcF9tb3ZlID0gdHJ1ZTtcbiAgICAgICAgICAgIHRoaXMubW92ZW1lbnRfZGlyZWN0aW9uID0gXCJjX3J1bl9sXCI7XG4gICAgICAgICAgICB0aGlzLmFuaW1fc2VsZWN0KCk7XG5cbiAgICAgICAgfVxuICAgICAgICAvL+WHoOenjeS4jeWQjOeahOenu+WKqOetlueVpVxuICAgICAgICBzd2l0Y2ggKHRoaXMubW92ZW1lbnRfZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICBjYXNlIFwiel9pZGxlXCI6XG4gICAgICAgICAgICAgICAgcyA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY19pZGxlXCI6XG4gICAgICAgICAgICAgICAgcyA9IDA7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY19ydW5fbFwiOlxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS54IC09IHM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIFwiY19ydW5fclwiOlxuICAgICAgICAgICAgICAgIHRoaXMubm9kZS54ICs9IHM7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH07XG5cbiAgICB9LFxuICAgIC8vYXV0byB3b3JrXG4gICAgYXV0b193b3JrOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBsYW5kX2pzID0gdGhpcy5ub2RlLnBhcmVudC5nZXRDb21wb25lbnQoXCJsYW5kXCIpO1xuICAgICAgICB2YXIgbGFuZF9pbmRleCA9IGxhbmRfanMubGFuZF9pbmRleDtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgLy/lt6XkvZznirbmgIHlt6XkvZxcbiAgICAgICAgICAgIGlmICh0aGlzLndvcmtfc3RhdGUgPT0gXCJ3b3JrXCIpIHtcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHVzZXJfZGF0YS51c2VyX2RhdGEubGFuZFtsYW5kX2luZGV4XS5sYW5kX3N0YXRlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJ3YWl0X2N1dFwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgbGFuZF9qcy5jdXQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiZ3Jvd1wiOlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHVzZXJfZGF0YS51c2VyX2RhdGEubGFuZFtsYW5kX2luZGV4XS53YXRlcl9udW0gPD0gMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxhbmRfanMud2F0ZXJfY2hhcmdlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICAgICB9Oy8vZW5kIHN3aXRjaFxuICAgICAgICAgICAgICAgIC8vIGNjLmxvZyhcIuW3peS9nOS4rVwiKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfTsgLy9lbmQgaWZcblxuICAgICAgICB9O1xuICAgICAgICB0aGlzLnNjaGVkdWxlKGNhbGxiYWNrLCAwLjUsIGNjLm1hY3JvLlJFUEVBVF9GT1JFVkVSKTtcbiAgICB9LFxuICAgIC8v5bel5L2c5a6a5pe25ZmoXG4gICAgd29ya19zY2hlZHVsZTogZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIHRoaXMud29ya19zdGF0ZSA9IFwid29ya1wiO1xuXG4gICAgICAgIHZhciB3b3JrX3RpbWUgPSBjb25maWcuc3RhZmZbdGhpcy5zdGFmZl9pbmRleF0ud29ya190aW1lICsgdXNlcl9kYXRhLnVzZXJfZGF0YS5za2lsbFtcImxhYm9yX2NvbnRyYWN0XCJdO1xuICAgICAgICB2YXIgY2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICB3b3JrX3RpbWUtLTtcbiAgICAgICAgICAgIGlmICh3b3JrX3RpbWUgPD0gMCkge1xuICAgICAgICAgICAgICAgIHRoaXMudW5zY2hlZHVsZShjYWxsYmFjayk7XG4gICAgICAgICAgICAgICAgLy/lgZzmraLlt6XkvZzorqHml7blmahcbiAgICAgICAgICAgICAgICAvLyBjYy5sb2codGhpcy5zdGFmZl9pbmRleCwgXCLlj7fkvJHmga9cIik7XG4gICAgICAgICAgICAgICAgdmFyIG5vd190aW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgLyAxMDAwO1xuICAgICAgICAgICAgICAgIHVzZXJfZGF0YS51c2VyX2RhdGEuc3RhZmZbdGhpcy5zdGFmZl9pbmRleF0ub3Zlcl90aW1lID0gbm93X3RpbWU7XG4gICAgICAgICAgICAgICAgdGhpcy5yZXN0X3NjaGVkdWxlKCk7XG4gICAgICAgICAgICB9Oy8vZW5kIGlmXG4gICAgICAgIH07Ly9lbmQgY2FsbGJhY2tcblxuICAgICAgICB0aGlzLnNjaGVkdWxlKGNhbGxiYWNrLCAxLCBjYy5tYWNyby5SRVBFQVRfRk9SRVZFUik7XG4gICAgfSxcbiAgICAvL+S8keaBr+aXtuWwj+S6uuiiq+eCueWHu1xuICAgIG9uX3N0YWZmX25vZGVfdG91Y2goKSB7XG4gICAgICAgIHRoaXMuc291bmRfY29udHJvbC5wbGF5X3NvdW5kX2VmZmVjdChcImJ1dHRvbl9jbGlja1wiKTtcbiAgICAgICAgdGhpcy5nYW1lX3NjZW5lX2pzLmNyZWF0ZV9yZXN0X3VpKHRoaXMuZ2FtZV9zY2VuZV9qcy5ub2RlLCB0aGlzLnN0YWZmX2luZGV4KTtcbiAgICB9LFxuICAgIC8v5LyR5oGv5a6a5pe25ZmoXG4gICAgcmVzdF9zY2hlZHVsZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLndvcmtfc3RhdGUgPSBcInJlc3RcIjtcbiAgICAgICAgdmFyIGNhbGxiYWNrID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgaWYgKHRoaXMud29ya19zdGF0ZSA9PSBcInJlc3RcIikge1xuXG4gICAgICAgICAgICAgICAgLy/lkK/liqjnm5HlkKzkuovku7ZcbiAgICAgICAgICAgICAgICB0aGlzLnN0YWZmX25vZGUub24oXCJ0b3VjaHN0YXJ0XCIsIHRoaXMub25fc3RhZmZfbm9kZV90b3VjaCwgdGhpcyk7XG4gICAgICAgICAgICAgICAgdGhpcy5wdXBwbGVfbm9kZS5vbihcInRvdWNoc3RhcnRcIiwgdGhpcy5vbl9zdGFmZl9ub2RlX3RvdWNoLCB0aGlzKVxuICAgICAgICAgICAgICAgIHZhciBub3dfdGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpIC8gMTAwMDtcbiAgICAgICAgICAgICAgICB2YXIgb3Zlcl90aW1lID0gdXNlcl9kYXRhLnVzZXJfZGF0YS5zdGFmZlt0aGlzLnN0YWZmX2luZGV4XS5vdmVyX3RpbWU7XG4gICAgICAgICAgICAgICAgdmFyIHJlc3RfdGltZSA9IGNvbmZpZy5zdGFmZlt0aGlzLnN0YWZmX2luZGV4XS5yZXN0X3RpbWUgLSB1c2VyX2RhdGEudXNlcl9kYXRhLnRyYWRlci5yZWNpcGVzO1xuXG4gICAgICAgICAgICAgICAgLy/kvJHmga/ml7bpl7TmnIDlsI/lgLzkuLowXG4gICAgICAgICAgICAgICAgaWYgKHJlc3RfdGltZSA8PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3RfdGltZSA9IDA7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIC8v5rKh5pyJ5bel5L2c6L+H5bCx55u05o6l5bel5L2cXG4gICAgICAgICAgICAgICAgaWYgKG92ZXJfdGltZSA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMud29ya19zY2hlZHVsZSgpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnB1cHBsZV9ub2RlLmFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnVuc2NoZWR1bGUoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKG5vd190aW1lIC0gb3Zlcl90aW1lID49IHJlc3RfdGltZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy/kvJHmga/nu5PmnZ9cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZyh0aGlzLnN0YWZmX2luZGV4LCBcIuW8gOWni+W3peS9nFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucHVwcGxlX25vZGUuYWN0aXZlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnVuc2NoZWR1bGUoY2FsbGJhY2spO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy53b3JrX3NjaGVkdWxlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN0YWZmX25vZGUub2ZmKFwidG91Y2hzdGFydFwiLCB0aGlzLm9uX3N0YWZmX25vZGVfdG91Y2gsIHRoaXMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wdXBwbGVfbm9kZS5vbihcInRvdWNoc3RhcnRcIiwgdGhpcy5vbl9zdGFmZl9ub2RlX3RvdWNoLCB0aGlzKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNjLmxvZyhcIuS8keaBr1wiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMud29ya19zdGF0ZSA9IFwicmVzdFwiO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5wdXBwbGVfbm9kZS5hY3RpdmUgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9Oy8vZW5kIGlmXG5cbiAgICAgICAgICAgICAgICB9Oy8vZW5kIGlmXG5cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy51bnNjaGVkdWxlKGNhbGxiYWNrKTtcbiAgICAgICAgICAgIH07Ly8gZW5kIGlmXG5cbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5zY2hlZHVsZShjYWxsYmFjaywgMC41LCBjYy5tYWNyby5SRVBFQVRfRk9SRVZFUik7XG4gICAgfSxcbiAgICBpbmlfbm9kZTogZnVuY3Rpb24gKHN0YWZmX2luZGV4KSB7XG4gICAgICAgIHRoaXMuZ2FtZV9zY2VuZV9qcyA9IGNjLmZpbmQoXCJVSV9ST09UXCIpLmdldENvbXBvbmVudChcImdhbWVfc2NlbmVcIik7O1xuICAgICAgICB0aGlzLnNvdW5kX2NvbnRyb2wgPSBjYy5maW5kKFwic291bmRfY29udHJvbFwiKS5nZXRDb21wb25lbnQoXCJzb3VuZF9jb250cm9sXCIpO1xuICAgICAgICB0aGlzLmFkc01hbmFnZXJfanMgPSBjYy5maW5kKFwiVUlfUk9PVFwiKS5nZXRDb21wb25lbnQoXCJBZHNNYW5hZ2VyXCIpO1xuICAgICAgICB0aGlzLnN0YWZmX2luZGV4ID0gc3RhZmZfaW5kZXg7XG4gICAgICAgIHRoaXMuYWxsX2RpcmVjdGlvbiA9IFtcInpfaWRsZVwiLCBcImNfaWRsZVwiLCBcImNfcnVuX2xcIiwgXCJjX3J1bl9yXCJdO1xuICAgICAgICB0aGlzLnJlc3RfZGlyZWN0aW9uID0gW1wiel9pZGxlXCIsIFwiY19pZGxlXCJdO1xuICAgICAgICB0aGlzLm1vdmVtZW50X2RpcmVjdGlvbiA9IFwiel9pZGxlXCI7XG4gICAgICAgIC8v5bCP5Lq655qE56e75Yqo6YCf5bqmXG4gICAgICAgIHRoaXMubW92ZV9zcGVlZCA9IDMwO1xuICAgICAgICAvL+WBnOatouenu+WKqO+8jOi+uee8mOaXtuinpuWPkVxuICAgICAgICB0aGlzLnN0b3BfbW92ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLnN0YWZmX3N0YXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy53b3JrX3N0YXRlID0gbnVsbDtcbiAgICAgICAgdGhpcy5ub2RlLnNldFBvc2l0aW9uKDAsIC0xNDApO1xuICAgIH0sXG5cbiAgICBvbkxvYWQoKSB7XG5cbiAgICB9LFxuXG4gICAgc3RhcnQoKSB7XG4gICAgICAgIHRoaXMuY2hhbmdlX21vdmVtZW50X2RpcmVjdGlvbigpO1xuICAgICAgICB0aGlzLmFuaW1fc2VsZWN0KCk7XG4gICAgICAgIHRoaXMucmVzdF9zY2hlZHVsZSgpO1xuICAgICAgICB0aGlzLmF1dG9fd29yaygpO1xuICAgIH0sXG5cbiAgICB1cGRhdGUoZHQpIHtcbiAgICAgICAgdGhpcy5haV9tb3ZlKGR0KTtcbiAgICB9LFxufSk7XG4iXX0=