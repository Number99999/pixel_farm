{"version":3,"sources":["assets\\script\\ui\\gift_ui.js"],"names":["user_data","require","cc","Class","Component","properties","center_node","Node","exit_button_node","introduce_label","Label","ini_node","ad_control","find","getComponent","adsManager_js","game_scene_js","game_rules_js","sound_control","scale","active","level","string","tween","to","easing","call","scheduleOnce","start","on_i_wanner_ad_button_click","play_sound_effect","showRewardedVideo","add_ex","create_tips_ui","node","now_ex","skill_point","set_ex_progress","unschedule","callback","destroy","on_exit_button_click","video_succes","wx","video_state","video_tag","schedule"],"mappings":"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","sourceRoot":"/","sourcesContent":["var user_data = require(\"user_data\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        center_node: cc.Node,\r\n        exit_button_node: cc.Node,\r\n        introduce_label: cc.Label,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    ini_node() {\r\n        this.ad_control = cc.find(\"ad_control\").getComponent(\"ad_control\");\r\n        this.adsManager_js = cc.find(\"UI_ROOT\").getComponent(\"AdsManager\");\r\n        this.game_scene_js = cc.find(\"UI_ROOT\").getComponent(\"game_scene\");\r\n        this.game_rules_js = cc.find(\"UI_ROOT\").getComponent(\"game_rules\");\r\n        this.sound_control = cc.find(\"sound_control\").getComponent(\"sound_control\");\r\n\r\n        this.center_node.scale = 0;\r\n        this.exit_button_node.active = false;\r\n        if (user_data.user_data.level < 15) {\r\n            this.introduce_label.string = \"Watch short commercials, \\nlevel+1\";\r\n        } else {\r\n            this.introduce_label.string = \"Watch short commercials and \\ngain half-level experience\";\r\n        };\r\n        cc.tween(this.center_node)\r\n            .to(0.3, { scale: 1 }, { easing: \"elasticOut\" })\r\n            .call(() => {\r\n                this.scheduleOnce(() => {\r\n                    this.exit_button_node.active = true;\r\n                }, 1.5)\r\n            })\r\n            .start();\r\n    },\r\n    //我要看视频按钮被点击\r\n    on_i_wanner_ad_button_click() {\r\n        this.sound_control.play_sound_effect(\"button_click\");\r\n        this.adsManager_js.showRewardedVideo(() => {\r\n            if (user_data.user_data.level > 15) {\r\n                this.game_rules_js.add_ex(user_data.user_data.level);\r\n                this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"gift_ad_ex\");\r\n            } else {\r\n                user_data.user_data.level++;\r\n                user_data.user_data.now_ex = 0;\r\n                user_data.user_data.skill_point++;\r\n                this.game_rules_js.set_ex_progress();\r\n                this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"gift_ad_level\");\r\n            };\r\n\r\n            this.unschedule(callback);\r\n            this.node.destroy();\r\n        });\r\n    },\r\n    //exit button\r\n    on_exit_button_click() {\r\n        this.sound_control.play_sound_effect(\"button_exit\");\r\n\r\n        this.node.destroy();\r\n    },\r\n    //检测视频是否播放成功\r\n    video_succes: function () {\r\n        if (typeof (wx) != \"undefined\") {\r\n            var callback = function () {\r\n                if (this.ad_control.video_state == 1 && this.ad_control.video_tag == \"gift_ad\") {\r\n                    this.ad_control.video_tag = null;\r\n                    this.ad_control.video_state = 2;\r\n                    if (user_data.user_data.level > 15) {\r\n                        this.game_rules_js.add_ex(user_data.user_data.level);\r\n                        this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"gift_ad_ex\");\r\n                    } else {\r\n                        user_data.user_data.level++;\r\n                        user_data.user_data.now_ex = 0;\r\n                        user_data.user_data.skill_point++;\r\n                        this.game_rules_js.set_ex_progress();\r\n                        this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"gift_ad_level\");\r\n                    };\r\n                    this.unschedule(callback);\r\n                    this.node.destroy();\r\n                } else {\r\n                    if (this.ad_control.video_tag == null && this.ad_control.video_state == 2) {\r\n                        this.unschedule(callback);\r\n                    };\r\n                };\r\n            };\r\n            this.schedule(callback, 0.2);\r\n        };\r\n    },\r\n    // onLoad () {},\r\n\r\n    start() {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}