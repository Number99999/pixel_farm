{"version":3,"sources":["assets\\script\\ui\\study_ui.js"],"names":["user_data","require","skill_content","cc","Class","Component","properties","skill_group_node","Node","skill_content_prefab","Prefab","skill_point_label","Label","ini_node","game_scene_js","find","getComponent","game_rules_js","ad_control","sound_control","show_bannerAd","create_content","children","length","skill_arr","Object","keys","skill","i","node","instantiate","parent","update_skill_point","string","skill_point","callback","schedule","macro","REPEAT_FOREVER","on_touch_exit","hide_bannerAd","play_sound_effect","on_node_kill","on_rest_skill_point_button_click","video_tag","video_state","level","arr","j","gold_max","gold","create_tips_ui","set_gold_progress","video_succes","wx","unschedule","onLoad","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["var user_data = require(\"user_data\");\nvar skill_content = require(\"skill_content\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        skill_group_node: cc.Node,\n        skill_content_prefab: cc.Prefab,\n        skill_point_label: cc.Label,\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n    ini_node: function () {\n        this.game_scene_js = cc.find(\"UI_ROOT\").getComponent(\"game_scene\");\n        this.game_rules_js = cc.find(\"UI_ROOT\").getComponent(\"game_rules\");\n        // this.skill_content_js = cc.find(\"skill_content\").getComponent(\"skill_content\");\n        this.ad_control = cc.find(\"ad_control\").getComponent(\"ad_control\");\n        this.sound_control = cc.find(\"sound_control\").getComponent(\"sound_control\");\n        this.ad_control.show_bannerAd();\n        this.create_content();\n    },\n    //\n    create_content: function () {\n        if (this.skill_group_node.children.length == 0) {\n            var skill_arr = Object.keys(user_data.user_data.skill);\n            for (var i = 0; i < skill_arr.length; i++) {\n                var node = cc.instantiate(this.skill_content_prefab);\n                node.parent = this.skill_group_node;\n                node.getComponent(\"skill_content\").ini_node(i);\n            };\n        } else {\n            return;\n        };\n    },\n    //skill_point\n    update_skill_point: function () {\n        this.skill_point_label.string = user_data.user_data.skill_point;\n        var callback = function () {\n            this.skill_point_label.string = user_data.user_data.skill_point;\n        };\n        this.schedule(callback, 0.5, cc.macro.REPEAT_FOREVER);\n    },\n    \n    on_touch_exit: function () {\n        this.ad_control.hide_bannerAd();\n        this.sound_control.play_sound_effect(\"button_exit\");\n        this.game_scene_js.on_node_kill(this.node);\n    },\n    \n    on_rest_skill_point_button_click() {\n        this.sound_control.play_sound_effect(\"button_click\");\n        // this.ad_control.show_videoAd(\"skill_rest\");\n        this.ad_control.video_tag = null;\n        this.ad_control.video_state = 2;\n        var level = user_data.user_data.level;\n        var arr = Object.keys(user_data.user_data.skill);\n        user_data.user_data.skill_point = level;\n        var skill_arr = Object.keys(user_data.user_data.skill);\n        //reset skill to lv 0\n        for (var j = 0; j < arr.length; j++) {\n            if (arr[j] == \"offline_profit\") {\n                user_data.user_data.skill[\"offline_profit\"] = 1;\n            } else {\n                user_data.user_data.skill[arr[j]] = 0;\n            };\n        };\n        var gold_max = 500 * user_data.user_data.skill[\"gold_max\"] + 500;\n        if(user_data.user_data.gold > gold_max) user_data.user_data.gold = gold_max;\n        // reset skill_content\n        for (var i = 0; i < skill_arr.length; i++) {\n            this.skill_group_node.children[i].getComponent(\"skill_content\").ini_node(i);\n        };\n        this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"skill_rest\");\n        this.game_rules_js.set_gold_progress();\n\n    },\n    \n    video_succes: function () {\n        if (typeof (wx) != \"undefined\") {\n            var callback = function () {\n                if (this.ad_control.video_state == 1 && this.ad_control.video_tag == \"skill_rest\") {\n                    this.ad_control.video_tag = null;\n                    this.ad_control.video_state = 2;\n                    var level = user_data.user_data.level;\n                    var arr = Object.keys(user_data.user_data.skill);\n                    user_data.user_data.skill_point = level;\n                    var skill_arr = Object.keys(user_data.user_data.skill);\n                    //重置skill 为 0\n                    for (var j = 0; j < arr.length; j++) {\n                        //离线收益保证至少1级\n                        if (arr[j] == \"offline_profit\") {\n                            user_data.user_data.skill[\"offline_profit\"] = 1;\n                        } else {\n                            user_data.user_data.skill[arr[j]] = 0;\n                        };\n                    };\n                    //刷新skill_content\n                    for (var i = 0; i < skill_arr.length; i++) {\n                        this.skill_group_node.children[i].getComponent(\"skill_content\").ini_node(i);\n                    };\n                    this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"skill_rest\");\n                    this.game_rules_js.set_gold_progress();\n                    this.unschedule(callback);\n                } else {\n                    if (this.ad_control.video_tag == null && this.ad_control.video_state == 2) {\n                        this.unschedule(callback);\n                    };\n                };\n            };\n            this.schedule(callback, 0.2);\n        };\n    },\n    onLoad() {\n\n    },\n\n    start() {\n        this.update_skill_point();\n    },\n\n    // update (dt) {},\n});\n"]}