{"version":3,"sources":["assets\\script\\ui\\study_ui.js"],"names":["user_data","require","skill_content","cc","Class","Component","properties","skill_group_node","Node","skill_content_prefab","Prefab","skill_point_label","Label","ini_node","game_scene_js","find","getComponent","game_rules_js","adsManager_js","ad_control","sound_control","create_content","children","length","skill_arr","Object","keys","skill","i","node","instantiate","parent","update_skill_point","string","skill_point","callback","schedule","macro","REPEAT_FOREVER","on_touch_exit","play_sound_effect","on_node_kill","on_rest_skill_point_button_click","showRewardedVideo","level","arr","j","gold_max","gold","create_tips_ui","set_gold_progress","video_succes","wx","video_state","video_tag","unschedule","onLoad","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["var user_data = require(\"user_data\");\r\nvar skill_content = require(\"skill_content\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        skill_group_node: cc.Node,\r\n        skill_content_prefab: cc.Prefab,\r\n        skill_point_label: cc.Label,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    ini_node: function () {\r\n        this.game_scene_js = cc.find(\"UI_ROOT\").getComponent(\"game_scene\");\r\n        this.game_rules_js = cc.find(\"UI_ROOT\").getComponent(\"game_rules\");\r\n        this.adsManager_js = cc.find(\"UI_ROOT\").getComponent(\"AdsManager\");\r\n        // this.skill_content_js = cc.find(\"skill_content\").getComponent(\"skill_content\");\r\n        this.ad_control = cc.find(\"ad_control\").getComponent(\"ad_control\");\r\n        this.sound_control = cc.find(\"sound_control\").getComponent(\"sound_control\");\r\n        this.create_content();\r\n    },\r\n    //\r\n    create_content: function () {\r\n        if (this.skill_group_node.children.length == 0) {\r\n            var skill_arr = Object.keys(user_data.user_data.skill);\r\n            for (var i = 0; i < skill_arr.length; i++) {\r\n                var node = cc.instantiate(this.skill_content_prefab);\r\n                node.parent = this.skill_group_node;\r\n                node.getComponent(\"skill_content\").ini_node(i);\r\n            };\r\n        } else {\r\n            return;\r\n        };\r\n    },\r\n    //skill_point\r\n    update_skill_point: function () {\r\n        this.skill_point_label.string = user_data.user_data.skill_point;\r\n        var callback = function () {\r\n            this.skill_point_label.string = user_data.user_data.skill_point;\r\n        };\r\n        this.schedule(callback, 0.1, cc.macro.REPEAT_FOREVER);\r\n    },\r\n\r\n    on_touch_exit: function () {\r\n        this.sound_control.play_sound_effect(\"button_exit\");\r\n        this.game_scene_js.on_node_kill(this.node);\r\n    },\r\n\r\n    on_rest_skill_point_button_click() {\r\n        this.sound_control.play_sound_effect(\"button_click\");\r\n        this.adsManager_js.showRewardedVideo(() => {\r\n            var level = user_data.user_data.level;\r\n            var arr = Object.keys(user_data.user_data.skill);\r\n            user_data.user_data.skill_point = level;\r\n            var skill_arr = Object.keys(user_data.user_data.skill);\r\n            //reset skill to lv 0\r\n            for (var j = 0; j < arr.length; j++) {\r\n                if (arr[j] == \"offline_profit\") {\r\n                    user_data.user_data.skill[\"offline_profit\"] = 1;\r\n                } else {\r\n                    user_data.user_data.skill[arr[j]] = 0;\r\n                };\r\n            };\r\n            var gold_max = 500 * user_data.user_data.skill[\"gold_max\"] + 500;\r\n            if (user_data.user_data.gold > gold_max) user_data.user_data.gold = gold_max;\r\n            // reset skill_content\r\n            for (var i = 0; i < skill_arr.length; i++) {\r\n                this.skill_group_node.children[i].getComponent(\"skill_content\").ini_node(i);\r\n            };\r\n            this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"skill_rest\");\r\n            this.game_rules_js.set_gold_progress();\r\n        });\r\n    },\r\n\r\n    video_succes: function () {\r\n        if (typeof (wx) != \"undefined\") {\r\n            var callback = function () {\r\n                if (this.ad_control.video_state == 1 && this.ad_control.video_tag == \"skill_rest\") {\r\n                    this.ad_control.video_tag = null;\r\n                    this.ad_control.video_state = 2;\r\n                    var level = user_data.user_data.level;\r\n                    var arr = Object.keys(user_data.user_data.skill);\r\n                    user_data.user_data.skill_point = level;\r\n                    var skill_arr = Object.keys(user_data.user_data.skill);\r\n                    for (var j = 0; j < arr.length; j++) {\r\n                        if (arr[j] == \"offline_profit\") {\r\n                            user_data.user_data.skill[\"offline_profit\"] = 1;\r\n                        } else {\r\n                            user_data.user_data.skill[arr[j]] = 0;\r\n                        };\r\n                    };\r\n                    for (var i = 0; i < skill_arr.length; i++) {\r\n                        this.skill_group_node.children[i].getComponent(\"skill_content\").ini_node(i);\r\n                    };\r\n                    this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"skill_rest\");\r\n                    this.game_rules_js.set_gold_progress();\r\n                    this.unschedule(callback);\r\n                } else {\r\n                    if (this.ad_control.video_tag == null && this.ad_control.video_state == 2) {\r\n                        this.unschedule(callback);\r\n                    };\r\n                };\r\n            };\r\n            this.schedule(callback, 0.2);\r\n        };\r\n    },\r\n    onLoad() {\r\n\r\n    },\r\n\r\n    start() {\r\n        this.update_skill_point();\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}