{"version":3,"sources":["assets\\script\\ui\\study_ui.js"],"names":["user_data","require","skill_content","cc","Class","Component","properties","skill_group_node","Node","skill_content_prefab","Prefab","skill_point_label","Label","ini_node","game_scene_js","find","getComponent","game_rules_js","adsManager_js","ad_control","sound_control","show_bannerAd","create_content","children","length","skill_arr","Object","keys","skill","i","node","instantiate","parent","update_skill_point","string","skill_point","callback","schedule","macro","REPEAT_FOREVER","on_touch_exit","hide_bannerAd","play_sound_effect","on_node_kill","on_rest_skill_point_button_click","showRewardedVideo","level","arr","j","gold_max","gold","create_tips_ui","set_gold_progress","video_succes","wx","video_state","video_tag","unschedule","onLoad","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["var user_data = require(\"user_data\");\r\nvar skill_content = require(\"skill_content\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        skill_group_node: cc.Node,\r\n        skill_content_prefab: cc.Prefab,\r\n        skill_point_label: cc.Label,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    ini_node: function () {\r\n        this.game_scene_js = cc.find(\"UI_ROOT\").getComponent(\"game_scene\");\r\n        this.game_rules_js = cc.find(\"UI_ROOT\").getComponent(\"game_rules\");\r\n        this.adsManager_js = cc.find(\"UI_ROOT\").getComponent(\"AdsManager\");\r\n        // this.skill_content_js = cc.find(\"skill_content\").getComponent(\"skill_content\");\r\n        this.ad_control = cc.find(\"ad_control\").getComponent(\"ad_control\");\r\n        this.sound_control = cc.find(\"sound_control\").getComponent(\"sound_control\");\r\n        this.ad_control.show_bannerAd();\r\n        this.create_content();\r\n    },\r\n    //\r\n    create_content: function () {\r\n        if (this.skill_group_node.children.length == 0) {\r\n            var skill_arr = Object.keys(user_data.user_data.skill);\r\n            for (var i = 0; i < skill_arr.length; i++) {\r\n                var node = cc.instantiate(this.skill_content_prefab);\r\n                node.parent = this.skill_group_node;\r\n                node.getComponent(\"skill_content\").ini_node(i);\r\n            };\r\n        } else {\r\n            return;\r\n        };\r\n    },\r\n    //skill_point\r\n    update_skill_point: function () {\r\n        this.skill_point_label.string = user_data.user_data.skill_point;\r\n        var callback = function () {\r\n            this.skill_point_label.string = user_data.user_data.skill_point;\r\n        };\r\n        this.schedule(callback, 0.5, cc.macro.REPEAT_FOREVER);\r\n    },\r\n\r\n    on_touch_exit: function () {\r\n        this.ad_control.hide_bannerAd();\r\n        this.sound_control.play_sound_effect(\"button_exit\");\r\n        this.game_scene_js.on_node_kill(this.node);\r\n    },\r\n\r\n    on_rest_skill_point_button_click() {\r\n        this.sound_control.play_sound_effect(\"button_click\");\r\n        this.adsManager_js.showRewardedVideo(() => {\r\n            var level = user_data.user_data.level;\r\n            var arr = Object.keys(user_data.user_data.skill);\r\n            user_data.user_data.skill_point = level;\r\n            var skill_arr = Object.keys(user_data.user_data.skill);\r\n            //reset skill to lv 0\r\n            for (var j = 0; j < arr.length; j++) {\r\n                if (arr[j] == \"offline_profit\") {\r\n                    user_data.user_data.skill[\"offline_profit\"] = 1;\r\n                } else {\r\n                    user_data.user_data.skill[arr[j]] = 0;\r\n                };\r\n            };\r\n            var gold_max = 500 * user_data.user_data.skill[\"gold_max\"] + 500;\r\n            if (user_data.user_data.gold > gold_max) user_data.user_data.gold = gold_max;\r\n            // reset skill_content\r\n            for (var i = 0; i < skill_arr.length; i++) {\r\n                this.skill_group_node.children[i].getComponent(\"skill_content\").ini_node(i);\r\n            };\r\n            this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"skill_rest\");\r\n            this.game_rules_js.set_gold_progress();\r\n        });\r\n    },\r\n\r\n    video_succes: function () {\r\n        if (typeof (wx) != \"undefined\") {\r\n            var callback = function () {\r\n                if (this.ad_control.video_state == 1 && this.ad_control.video_tag == \"skill_rest\") {\r\n                    this.ad_control.video_tag = null;\r\n                    this.ad_control.video_state = 2;\r\n                    var level = user_data.user_data.level;\r\n                    var arr = Object.keys(user_data.user_data.skill);\r\n                    user_data.user_data.skill_point = level;\r\n                    var skill_arr = Object.keys(user_data.user_data.skill);\r\n                    //重置skill 为 0\r\n                    for (var j = 0; j < arr.length; j++) {\r\n                        //离线收益保证至少1级\r\n                        if (arr[j] == \"offline_profit\") {\r\n                            user_data.user_data.skill[\"offline_profit\"] = 1;\r\n                        } else {\r\n                            user_data.user_data.skill[arr[j]] = 0;\r\n                        };\r\n                    };\r\n                    //刷新skill_content\r\n                    for (var i = 0; i < skill_arr.length; i++) {\r\n                        this.skill_group_node.children[i].getComponent(\"skill_content\").ini_node(i);\r\n                    };\r\n                    this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"skill_rest\");\r\n                    this.game_rules_js.set_gold_progress();\r\n                    this.unschedule(callback);\r\n                } else {\r\n                    if (this.ad_control.video_tag == null && this.ad_control.video_state == 2) {\r\n                        this.unschedule(callback);\r\n                    };\r\n                };\r\n            };\r\n            this.schedule(callback, 0.2);\r\n        };\r\n    },\r\n    onLoad() {\r\n\r\n    },\r\n\r\n    start() {\r\n        this.update_skill_point();\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}