{"version":3,"sources":["assets\\script\\ui\\videotape_ui.js"],"names":["cc","Class","Component","properties","gold_lable","Label","ex_label","tips_label","button_frame","Sprite","button_frame_arr","SpriteFrame","purse_node","Node","ex_node","delete_button","Button","ini_node","game_rules_js","find","getComponent","game_scene_js","sound_control","ad_control","show_bannerAd","string","user_data","videotape_share_count","add_gold","Math","floor","skill","add_ex","level","videotape_path","spriteFrame","node","active","on_button_click","play_sound_effect","start_videotape","touch_exit","video_share","on_delete_button_click","create_tips_ui","wx","self","shareAppMessage","channel","title","extra","videoPath","videoTopics","success","console","log","videotape_share_succes","fail","videotape_share_fail","parent","gold","ex","i","create_gold_effect","create_ex_effect","hide_bannerAd","on_node_kill","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["import user_data from \"user_data\";\nimport config from \"config\";\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        gold_lable: cc.Label,\n        ex_label: cc.Label,\n        tips_label: cc.Label,\n        button_frame: cc.Sprite,\n        button_frame_arr: [cc.SpriteFrame],\n        purse_node: cc.Node,\n        ex_node: cc.Node,\n        delete_button: cc.Button,\n    },\n    //初始化节点\n    ini_node() {\n        this.game_rules_js = cc.find(\"UI_ROOT\").getComponent(\"game_rules\");\n        this.game_scene_js = cc.find(\"UI_ROOT\").getComponent(\"game_scene\");\n        this.sound_control = cc.find(\"sound_control\").getComponent(\"sound_control\");\n        this.ad_control = cc.find(\"ad_control\").getComponent(\"ad_control\");\n        this.ad_control.show_bannerAd();\n        // this.tips_label.string = \"今日分享:\" + user_data.user_data.videotape_share_count + \"/\" + config.videotape_share_max;\n        this.tips_label.string = \"Successfully shared:\" + user_data.user_data.videotape_share_count +\"Second-rate\";\n        this.add_gold = Math.floor(((500 * user_data.user_data.skill[\"gold_max\"] + 500)) / 20) + 1;\n        this.add_ex = Math.floor(user_data.user_data.level / 10) + 1;\n\n        if (this.game_rules_js.videotape_path == null) {\n            //录屏未录制\n            this.button_frame.spriteFrame = this.button_frame_arr[0];\n            this.delete_button.node.active = false;\n        } else {\n            //录屏已录制\n            this.button_frame.spriteFrame = this.button_frame_arr[1];\n            this.delete_button.node.active = true;\n        };\n\n        this.gold_lable.string = \"+\" + this.add_gold;\n        this.ex_label.string = \"+\" + this.add_ex;\n    },\n\n    //按钮被点击\n    on_button_click() {\n        //未开始录制点击变开始\n        this.sound_control.play_sound_effect(\"button_click\");\n\n        // if (user_data.user_data.videotape_share_count < config.videotape_share_max) {\n        //还有剩余分享次数\n        // } else {\n        //     //提示已达分享次数\n        //     this.sound_control.play_sound_effect(\"un_click\");\n        //     this.game_scene_js.create_tips_ui(this.game_rules_js.node, \"share_max\");\n        // };\n\n        if (this.game_rules_js.videotape_path == null) {\n            this.game_rules_js.start_videotape();\n            this.touch_exit();\n        } else {\n            this.video_share();\n        };\n\n\n    },\n\n    \n    on_delete_button_click() {\n        this.game_rules_js.videotape_path = null;\n        this.game_scene_js.create_tips_ui(this.game_rules_js.node, \"vidotape_cancel\");\n        this.ini_node();\n    },\n    //录屏分享\n    video_share: function () {\n        if (typeof (wx) !== \"undefined\") {\n            if (this.game_rules_js.videotape_path == null) {\n                return;\n            };\n            let self = this;\n            //获取分享导语\n            wx.shareAppMessage({\n                channel: 'video',  //指定为视频分享\n                title: 'On-Hook Small Farm',\n                extra: {\n                    videoPath: this.game_rules_js.videotape_path,// 设置视频路径\n                    videoTopics: [\"On-Hook Small Farm\", \"Game\"]\n                },\n                success: () => {\n                    //分享回调\n                    console.log('录屏分享成功');\n                    //分享奖励，仅一次\n                    self.videotape_share_succes();\n                },\n                fail: () => {\n                    console.log('录屏分享失败', this.videotape_path);\n                    self.videotape_share_fail();\n                }\n            });\n        };\n    },\n    //录屏分享成功\n    videotape_share_succes: function () {\n        this.game_scene_js.create_tips_ui(this.node.parent, \"videotape_share_succes\");\n        this.game_rules_js.videotape_path = null;\n        user_data.user_data.videotape_share_count++;\n        var gold = Math.floor(this.add_gold / 6);\n        var ex = Math.floor(this.add_ex / 3);\n        for (var i = 0; i < 6; i++) {\n            this.game_scene_js.create_gold_effect(this.purse_node, i, gold);\n        };\n        for (var i = 0; i < 5; i++) {\n            this.game_scene_js.create_ex_effect(this.ex_node, i, ex);\n        };\n        this.ini_node();\n\n    },\n    //录屏分享失败\n    videotape_share_fail: function () {\n        this.game_scene_js.create_tips_ui(this.node.parent, \"videotape_share_fail\");\n        this.ini_node();\n    },\n    //点击退出\n    touch_exit() {\n        this.sound_control.play_sound_effect(\"button_exit\");\n        this.ad_control.hide_bannerAd();\n        this.game_scene_js.on_node_kill(this.node);\n    },\n    // onLoad () {},\n\n    start() {\n\n    },\n\n    // update (dt) {},\n});\n"]}