{"version":3,"sources":["assets\\script\\ui\\rest_ui.js"],"names":["user_data","require","config","cc","Class","Component","properties","role_sprite","Sprite","role_arr","SpriteFrame","center_node","Node","ini_node","staff_index","ad_control","find","getComponent","game_scene_js","adsManager_js","spriteFrame","scale","ini_anim","tween","to","easing","start","on_iwanna_button_click","log","sound_control","play_sound_effect","show_videoAd","video_succes","on_touch_exit_click","e","node","destroy","on_keep_rest_button_click","showRewardedVideo","callback","staff","now_time","Date","getTime","over_time","rest_time","create_tips_ui","schedule","wx","video_state","video_tag","unschedule","onLoad"],"mappings":"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","sourceRoot":"/","sourcesContent":["var user_data = require(\"user_data\");\r\nvar config = require(\"config\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        role_sprite: cc.Sprite,\r\n        role_arr: [cc.SpriteFrame],\r\n        center_node: cc.Node,\r\n    },\r\n    //初始化节点\r\n    ini_node(staff_index) {\r\n        this.ad_control = cc.find(\"ad_control\").getComponent(\"ad_control\");\r\n        this.game_scene_js = cc.find(\"UI_ROOT\").getComponent(\"game_scene\");\r\n        this.adsManager_js = cc.find(\"UI_ROOT\").getComponent(\"AdsManager\");\r\n        //初始小人的形象\r\n        this.staff_index = staff_index;\r\n        this.role_sprite.spriteFrame = this.role_arr[staff_index];\r\n        this.center_node.scale = 0;\r\n        this.ini_anim();\r\n    },\r\n    //初始化动画\r\n    ini_anim() {\r\n        cc.tween(this.center_node)\r\n            .to(0.3, { scale: 1 }, { easing: \"sineOut\" })\r\n            .start();\r\n    },\r\n    //i wanna button click\r\n    on_iwanna_button_click() {\r\n        cc.log(\"create_ad\");\r\n        this.sound_control.play_sound_effect(\"button_click\");\r\n        this.ad_control.show_videoAd(\"staff_rest\");\r\n        this.video_succes();\r\n    },\r\n    on_touch_exit_click(e) {\r\n        this.node.destroy();\r\n    },\r\n    //keep rest\r\n    on_keep_rest_button_click() {\r\n        // user_data.user_data.staff[this.staff_index].now_time = new Date().getTime() /1000;\r\n        // user_data.user_data.staff[this.staff_index].over_time -= config.staff[this.staff_index].rest_time;\r\n        // console.log(\"43 now time \" + user_data.user_data.staff[this.staff_index].now_time );\r\n        // console.log(\"44 rest time \" + config.staff[this.staff_index].rest_time );\r\n        // console.log(\"45 over time\" + user_data.user_data.staff[this.staff_index].over_time);\r\n        this.adsManager_js.showRewardedVideo(() => {\r\n            var callback = function () {\r\n                // this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"staff_rest_over\");\r\n                user_data.user_data.staff[this.staff_index].now_time = new Date().getTime() / 1000;\r\n                user_data.user_data.staff[this.staff_index].over_time -= config.staff[this.staff_index].rest_time;\r\n                this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"staff_rest_over\");\r\n                this.node.destroy();\r\n            };\r\n            this.schedule(callback, 0.2);\r\n        });\r\n    },\r\n\r\n    //检测视频是否播放成功\r\n    video_succes: function () {\r\n        if (typeof (wx) != \"undefined\") {\r\n            var callback = function () {\r\n                if (this.ad_control.video_state == 1 && this.ad_control.video_tag == \"staff_rest\") {\r\n                    this.ad_control.video_tag = null;\r\n                    this.ad_control.video_state = 2;\r\n                    user_data.user_data.staff[this.staff_index].over_time = 0;\r\n                    this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"staff_rest_over\");\r\n                    this.unschedule(callback);\r\n                    this.node.destroy();\r\n                } else {\r\n                    if (this.ad_control.video_tag == null && this.ad_control.video_state == 2) {\r\n                        this.unschedule(callback);\r\n                    };\r\n                };\r\n            };\r\n            this.schedule(callback, 0.2);\r\n        };\r\n    },\r\n    onLoad() { },\r\n\r\n    start() {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}