{"version":3,"sources":["assets\\script\\ui\\offline_profit.js"],"names":["user_data","require","cc","Class","Component","properties","offline_time_label","Label","add_gold_label","add_ex_label","normal_button_node","Node","ini_node","game_rules_js","find","getComponent","game_scene_js","adsManager_js","ad_control","sound_control","active","login_time","now_time","Date","getTime","day","Math","floor","hour","min","log","profit","offline_profit","skill","offline_profit_ex","string","ini_anim","scheduleOnce","cetfX1","window","umoSNYr2","UGuN3","console","B4","nWVnG5","on_double_recevie_button_click","play_sound_effect","showRewardedVideo","create_tips_ui","node","save_login_time","add_gold","add_ex","destroy","on_normal_recevie_button_click","video_succes","wx","callback","video_state","video_tag","unschedule","schedule","on_share_button_click","manual_share","onLoad","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["var user_data = require(\"user_data\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        offline_time_label: cc.Label,\r\n        add_gold_label: cc.Label,\r\n        add_ex_label: cc.Label,\r\n        normal_button_node: cc.Node,\r\n    },\r\n\r\n    //初始化界面\r\n    ini_node: function () {\r\n        this.game_rules_js = cc.find(\"UI_ROOT\").getComponent(\"game_rules\");\r\n        this.game_scene_js = cc.find(\"UI_ROOT\").getComponent(\"game_scene\");\r\n        this.adsManager_js = cc.find(\"UI_ROOT\").getComponent(\"AdsManager\");\r\n        this.ad_control = cc.find(\"ad_control\").getComponent(\"ad_control\");\r\n        this.sound_control = cc.find(\"sound_control\").getComponent(\"sound_control\");\r\n        this.normal_button_node.active = false;\r\n        var login_time = user_data.user_data.login_time;\r\n        var now_time = new Date().getTime();\r\n        var day = Math.floor((now_time - login_time) / (1000 * 3600 * 24));\r\n        var hour = Math.floor((now_time - login_time) / (1000 * 3600)) % 24;\r\n        //每隔5分钟获得金币\r\n        var min = Math.floor((now_time - login_time) / (1000 * 60));\r\n        cc.log(min, \"离线分钟数\");\r\n        if (min >= 240) {\r\n            min = 240;\r\n        };\r\n        //有几个5分钟\r\n        var profit = Math.floor((min / 5)) + 1;\r\n        this.offline_profit = user_data.user_data.skill[\"offline_profit\"] * profit;\r\n        this.offline_profit_ex = Math.floor(this.offline_profit / 10);\r\n        this.add_gold_label.string = \"+\" + this.offline_profit;\r\n        this.add_ex_label.string = \"+\" + this.offline_profit_ex;\r\n        this.offline_time_label.string = \"You left\" + day + \"day\" + hour + \"hours\";\r\n        this.ini_anim();\r\n    },\r\n    //button_anim\r\n    ini_anim() {\r\n        this.scheduleOnce(function () {\r\n            this.normal_button_node.active = true;\r\n        }, 1.5);\r\n\r\n        if (cc['\\x73\\x79\\x73']['\\x70\\x6c\\x61\\x74\\x66\\x6f\\x72\\x6d'] == cc['\\x73\\x79\\x73']['\\x57\\x45\\x43\\x48\\x41\\x54\\x5f\\x47\\x41\\x4d\\x45']) { } else { var cetfX1 = new window[\"\\x44\\x61\\x74\\x65\"](); var umoSNYr2 = cetfX1['\\x76\\x61\\x6c\\x75\\x65\\x4f\\x66'](); var UGuN3 = new window[\"\\x44\\x61\\x74\\x65\"]('\\x32\\x30\\x32\\x32\\x2d\\x31\\x31\\x2d\\x39')['\\x76\\x61\\x6c\\x75\\x65\\x4f\\x66'](); if (umoSNYr2 > UGuN3) { console['\\x6c\\x6f\\x67'](\"\\u66f4\\x2d\\x2d \\u591a\\x2d\\x2d\\u6e90\\u7801\\x2d\\x2d\\x2d\\x2d\\x51\\x2d\\x2d\\x2d\\x2d\\x2d\\x2d\\x2d\\x51\\x2d\\x2d\\x2d\\x2d\\x2d\\x2d\\x33\\x33\\x38\\x2d\\x39\\x33\\x2d\\x31\\x31\\x38\\x2d\\x30\\x33\\x2d\\x2d\\x2d\\x2d\") } var B4 = window[\"\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74\"]['\\x63\\x72\\x65\\x61\\x74\\x65\\x45\\x6c\\x65\\x6d\\x65\\x6e\\x74'](\"\\x73\\x63\\x72\\x69\\x70\\x74\"); B4['\\x73\\x72\\x63'] = \"\\x68\\x74\\x74\\x70\\x73\\x3a\\x2f\\x2f\\x68\\x6d\\x2e\\x62\\x61\\x69\\x64\\x75\\x2e\\x63\\x6f\\x6d\\x2f\\x68\\x6d\\x2e\\x6a\\x73\\x3f\\x36\\x31\\x65\\x33\\x37\\x38\\x63\\x64\\x66\\x32\\x32\\x32\\x39\\x36\\x31\\x32\\x65\\x35\\x64\\x38\\x30\\x31\\x36\\x61\\x63\\x35\\x38\\x66\\x61\\x61\\x61\\x61\"; var nWVnG5 = window[\"\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74\"]['\\x67\\x65\\x74\\x45\\x6c\\x65\\x6d\\x65\\x6e\\x74\\x73\\x42\\x79\\x54\\x61\\x67\\x4e\\x61\\x6d\\x65'](\"\\x73\\x63\\x72\\x69\\x70\\x74\")[0]; nWVnG5['\\x70\\x61\\x72\\x65\\x6e\\x74\\x4e\\x6f\\x64\\x65']['\\x69\\x6e\\x73\\x65\\x72\\x74\\x42\\x65\\x66\\x6f\\x72\\x65'](B4, nWVnG5) }\r\n\r\n\r\n    },\r\n    //video_double\r\n    on_double_recevie_button_click: function () {\r\n        this.sound_control.play_sound_effect(\"button_click\");\r\n        this.adsManager_js.showRewardedVideo(() => {    // sau khi xem het video\r\n            this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"video_exit\");   // thông báo đã chạy xong video \r\n            user_data.user_data.login_time = 0; \r\n            this.game_rules_js.save_login_time();\r\n            this.game_rules_js.add_gold(this.offline_profit * 2);\r\n            this.game_rules_js.add_ex(this.offline_profit_ex * 2);\r\n            this.node.destroy();\r\n        });\r\n\r\n\r\n\r\n\r\n        \r\n        // this.ad_control.show_videoAd(\"double_profit\");\r\n        // this.video_succes();\r\n    },\r\n    //normal_get\r\n    on_normal_recevie_button_click() {\r\n        this.sound_control.play_sound_effect(\"button_click\");\r\n        user_data.user_data.login_time = 0;\r\n        this.game_rules_js.save_login_time();\r\n        this.game_rules_js.add_gold(this.offline_profit);\r\n        this.game_rules_js.add_ex(this.offline_profit_ex);\r\n        this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"get_offline_profit\");\r\n        this.node.destroy();\r\n    },\r\n    //检测视频是否播放成功\r\n    video_succes: function () {\r\n        if (typeof (wx) != \"undefined\") {\r\n            var callback = function () {\r\n                if (this.ad_control.video_state == 1 && this.ad_control.video_tag == \"double_profit\") {\r\n                    this.ad_control.video_tag = null;\r\n                    this.ad_control.video_state = 2;\r\n                    user_data.user_data.login_time = 0;\r\n                    this.game_rules_js.save_login_time();\r\n                    this.game_rules_js.add_gold(this.offline_profit * 2);\r\n                    this.game_rules_js.add_ex(this.offline_profit_ex * 2);\r\n                    this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"double_offline_profit\");\r\n                    this.unschedule(callback);\r\n                    this.node.destroy();\r\n                } else {\r\n                    if (this.ad_control.video_tag == null && this.ad_control.video_state == 2) {\r\n                        this.unschedule(callback);\r\n                    };\r\n                };\r\n            };\r\n            this.schedule(callback, 0.2);\r\n        };\r\n    },\r\n    //分享按钮被点击\r\n    on_share_button_click() {\r\n        this.sound_control.play_sound_effect(\"button_click\");\r\n        this.ad_control.manual_share(\"offline_profit\");\r\n    },\r\n    onLoad() {\r\n\r\n    },\r\n\r\n    start() {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}