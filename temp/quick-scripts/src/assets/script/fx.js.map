{"version":3,"sources":["assets\\script\\fx.js"],"names":["mergeJSON","n","o","oType","Object","prototype","toString","call","nType","p","hasOwnProperty","oPType","nPType","i","oIType","nIType","updata_user_data","local_user_data","now_ud","user_data","assign","cc","log","load","JSON","parse","sys","localStorage","getItem","save","err","cache_user_data","remove_all","setItem","stringify","removeItem"],"mappings":"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","sourceRoot":"/","sourcesContent":["import user_data from \"user_data\";\nexport default {\n    //更新存档\n    mergeJSON(n, o) {\n        let oType = Object.prototype.toString.call(o);\n        let nType = Object.prototype.toString.call(n);\n        if (nType == '[object Object]' && oType == '[object Object]') {\n            //合并属性(object)\n            for (let p in n) {\n                if (n.hasOwnProperty(p) && !o.hasOwnProperty(p)) {\n                    //新的有，旧的没有\n                    o[p] = n[p];\n                } else if (n.hasOwnProperty(p) && (o.hasOwnProperty(p))) {\n                    //两者都有\n                    let oPType = Object.prototype.toString.call(o[p]);\n                    let nPType = Object.prototype.toString.call(n[p]);\n                    if ((nPType == '[object Object]' && oPType == '[object Object]') || (nPType == '[object Array]' && oPType == '[object Array]')) {\n                        this.mergeJSON(n[p], o[p]);\n                    }\n                };\n            }\n        } else if (nType == '[object Array]' && oType == '[object Array]') {\n            //合并属性(array)\n            for (let i in n) {\n                let oIType = Object.prototype.toString.call(o[i]);\n                let nIType = Object.prototype.toString.call(n[i]);\n                if ((nIType == '[object Object]' && oIType == '[object Object]') || (nIType == '[object Array]' && oIType == '[object Array]')) {\n                    this.mergeJSON(n[i], o[i]);\n                }\n            }\n        };\n        //合并属性(other)\n        n = o;\n        return n;\n    },\n    //刷新数据\n    updata_user_data: function (local_user_data) {\n        //合并对象，源对象合并到目标对象\n        //Object.assign(target,sources)\n        var now_ud = this.mergeJSON(user_data.user_data, local_user_data);\n        Object.assign(user_data.user_data, now_ud)\n        cc.log(user_data.user_data, \"user_data\");\n    },\n    //读取本地数据\n    load: function () {\n        try {\n            var local_user_data = JSON.parse(cc.sys.localStorage.getItem('user_data'));\n            // var local_user_data = null;\n            if (local_user_data !== null) {\n                this.updata_user_data(local_user_data);\n                cc.log(\"load successfull\");\n            } else {\n                this.save();\n                //否则就初始化\n            };\n        } catch (err) {\n            this.save();\n            cc.log(\"error load exception5\");\n            cc.log(err);\n        }\n    },\n    //将缓存数据写入到本地中\n    save: function () {\n        var cache_user_data = user_data.user_data;\n        this.remove_all();\n        cc.sys.localStorage.setItem('user_data', JSON.stringify(cache_user_data));\n        // cc.log(\"已存档\");\n        // cc.log(JSON.stringify(user_data));\n    },\n    //清除所有数据\n    remove_all: function () {\n        cc.sys.localStorage.removeItem('user_data');\n        // cc.log(\"清除本地所有数据\");\n    },\n\n};\n"]}