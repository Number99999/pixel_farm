{"version":3,"sources":["assets\\script\\ui\\land.js"],"names":["user_data","require","config","cc","Class","Component","properties","tips_node","Node","plant_node","plant_progress_node","water_progress_node","plant_progress_label","Label","button","button_frame_arr","SpriteFrame","land_frame_arr","plant0_frame_arr","plant1_frame_arr","plant2_frame_arr","plant3_frame_arr","plant4_frame_arr","plant5_frame_arr","plant6_frame_arr","plant7_frame_arr","set_plant","active","alive_stage","land","land_index","i","children","length","getComponent","Sprite","spriteFrame","plant_frame_arr","plant_type","plant_grow","land_state","grow_time","plant","now_time","bar","ProgressBar","watering","plant_grow_schedule","water_buff","unschedule","string","wait_next","progress","progress_num","parseInt","update_plant_alive_stage","schedule","plantSprite","plant_index","plant_count","rest_plat_alive_stage","water_schedule","type","state","cut","cut_time","skill","cut_schedule","sound_control","play_sound_effect","node","game_scene_js","create_light_effect","ini_node","on_button_click","create_plant_ui","till","all_water","all_water_num","water_num","have_water","water_charge","water_state","callback","now_water","index","find","have","plant_schedule","till_time","plant_time","onLoad","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["var user_data = require(\"user_data\");\r\nvar config = require(\"config\");\r\n\r\n/*land state :{\r\n    cut :\r\n    till:\r\n    water:\r\n    plant:\r\n    grow :\r\n};*/\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n    properties: {\r\n        tips_node: cc.Node,\r\n        plant_node: cc.Node,\r\n        plant_progress_node: cc.Node,\r\n        water_progress_node: cc.Node,\r\n        plant_progress_label: cc.Label,\r\n        button: cc.Node,\r\n        button_frame_arr: [cc.SpriteFrame],\r\n        land_frame_arr: [cc.SpriteFrame],\r\n        plant0_frame_arr: [cc.SpriteFrame],\r\n        plant1_frame_arr: [cc.SpriteFrame],\r\n        plant2_frame_arr: [cc.SpriteFrame],\r\n        plant3_frame_arr: [cc.SpriteFrame],\r\n        plant4_frame_arr: [cc.SpriteFrame],\r\n        plant5_frame_arr: [cc.SpriteFrame],\r\n        plant6_frame_arr: [cc.SpriteFrame],\r\n        plant7_frame_arr: [cc.SpriteFrame],\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    //设置种植的植物\r\n    set_plant: function () {\r\n        this.plant_node.active = true;\r\n        var alive_stage = user_data.user_data.land[this.land_index].alive_stage;\r\n        for (var i = 0; i < this.plant_node.children.length; i++) {\r\n            this.plant_node.children[i].getComponent(cc.Sprite).spriteFrame = this.plant_frame_arr[this.plant_type][alive_stage];\r\n        };\r\n        this.plant_grow();\r\n    },\r\n    //植物生长\r\n    plant_grow: function () {\r\n        user_data.user_data.land[this.land_index].land_state = \"grow\"; // note thì growing chạy quá 100%\r\n        var land_state = user_data.user_data.land[this.land_index].land_state;\r\n        this.plant_progress_node.active = true;\r\n        var grow_time = config.plant[this.plant_type].grow_time;\r\n        var now_time = 0;\r\n        var bar = this.plant_progress_node.getComponent(cc.ProgressBar);\r\n        this.watering();\r\n        this.plant_grow_schedule = function () {\r\n            now_time += 0.1 * this.water_buff;\r\n            if (now_time >= grow_time && land_state == \"grow\") {\r\n                this.unschedule(this.plant_grow_schedule);\r\n                this.plant_progress_label.string = \"Waiting for harvest\";\r\n                this.wait_next(\"wait_cut\");\r\n                return;\r\n            } else {\r\n                bar.progress = now_time / grow_time;\r\n                var progress_num = parseInt(bar.progress * 100);\r\n                this.plant_progress_label.string = \"Growing \" + progress_num + \"%\";\r\n                this.update_plant_alive_stage(progress_num);\r\n                if (progress_num < 25) {\r\n                    for (var i = 0; i < this.plant_node.children.length; i++) {\r\n                        this.plant_node.children[i].getComponent(cc.Sprite).spriteFrame = this.plant_frame_arr[this.plant_type][0];\r\n                    };\r\n                }\r\n                else if (progress_num < 50) {\r\n                    for (var i = 0; i < this.plant_node.children.length; i++) {\r\n                        this.plant_node.children[i].getComponent(cc.Sprite).spriteFrame = this.plant_frame_arr[this.plant_type][1];\r\n\r\n                    };\r\n                }\r\n                else if (progress_num < 75) {\r\n                    for (var i = 0; i < this.plant_node.children.length; i++) {\r\n                        this.plant_node.children[i].getComponent(cc.Sprite).spriteFrame = this.plant_frame_arr[this.plant_type][2];\r\n                    };\r\n                }\r\n                else for (var i = 0; i < this.plant_node.children.length; i++) {\r\n                    this.plant_node.children[i].getComponent(cc.Sprite).spriteFrame = this.plant_frame_arr[this.plant_type][3];\r\n                };\r\n            };\r\n        };\r\n        this.schedule(this.plant_grow_schedule, 0.1);\r\n    },\r\n    //更新植物等级\r\n    update_plant_alive_stage: function (progress_num) {\r\n        //2的倍数\r\n        var alive_stage = user_data.user_data.land[this.land_index].alive_stage;\r\n        let plantSprite = this.plant_node.children[this.plant_index].getComponent(cc.Sprite).spriteFrame;\r\n        if (plantSprite) {\r\n            plantSprite = this.plant_frame_arr[this.plant_type][alive_stage];\r\n        };\r\n        if (progress_num >= 25 / 12 * this.plant_count) {\r\n            this.plant_index++;\r\n            this.plant_count++;\r\n            if (this.plant_count > 48) {\r\n                this.plant_count = 48;\r\n            };\r\n            if (this.plant_index > 11) {\r\n                user_data.user_data.land[this.land_index].alive_stage++;\r\n                if (user_data.user_data.land[this.land_index].alive_stage > 3) {\r\n                    user_data.user_data.land[this.land_index].alive_stage = 3;\r\n                };\r\n                this.plant_index = 0;\r\n            };\r\n        };\r\n    },\r\n    //重置植物的生长状态\r\n    rest_plat_alive_stage: function () {\r\n        user_data.user_data.land[this.land_index].alive_stage = 0;\r\n        this.plant_index = 0;\r\n        this.plant_count = 0;\r\n        this.unschedule(this.water_schedule);\r\n        this.unschedule(this.plant_grow_schedule);\r\n        this.set_plant();\r\n    },\r\n    //đợi trạng thái tiếp theo\r\n    wait_next: function (type) {\r\n        this.button.state = type;\r\n        switch (type) {\r\n            case \"wait_cut\":\r\n                this.button.children[0].getComponent(cc.Sprite).spriteFrame = this.button_frame_arr[0];\r\n                user_data.user_data.land[this.land_index].land_state = \"wait_cut\";\r\n                break;\r\n            case \"plant\":\r\n                this.button.children[0].getComponent(cc.Sprite).spriteFrame = this.button_frame_arr[1];\r\n                break;\r\n            case \"wait_till\":\r\n                this.button.children[0].getComponent(cc.Sprite).spriteFrame = this.button_frame_arr[2];\r\n                break;\r\n\r\n        };\r\n        this.button.active = true;\r\n        this.unschedule(this.water_schedule);\r\n    },\r\n    //cutting\r\n    cut: function () {\r\n        if (user_data.user_data.land[this.land_index].land_state !== \"wait_cut\") {\r\n            return;\r\n        };\r\n        user_data.user_data.land[this.land_index].land_state = \"cuting\";\r\n        var land_state = user_data.user_data.land[this.land_index].land_state\r\n        this.button.active = false;\r\n        var cut_time = config.plant[this.plant_type].cut_time * (1 - user_data.user_data.skill[\"speed_the_cut\"] / 100);\r\n        var now_time = 0;\r\n        var bar = this.plant_progress_node.getComponent(cc.ProgressBar);\r\n        this.cut_schedule = function () {\r\n            now_time += 0.1;\r\n            if (now_time >= cut_time && land_state == \"cuting\") {\r\n                now_time = 0;\r\n                user_data.user_data.land[this.land_index].land_state = \"cut_over\";\r\n                this.sound_control.play_sound_effect(\"cut_over\");\r\n                this.unschedule(this.cut_schedule);\r\n                this.rest_plat_alive_stage();\r\n                var node = this.game_scene_js.create_light_effect(this.node, 1, this.plant_type);\r\n\r\n                if (node != null) {\r\n                    node.getComponent(\"light\").ini_node(this.plant_type, this.node);\r\n                };\r\n                return;\r\n            } else {\r\n                bar.progress = now_time / cut_time;\r\n                var progress_num = parseInt(bar.progress * 100);\r\n                this.plant_progress_label.string = \"Harvesting \" + progress_num + \"%\";\r\n            };\r\n        };\r\n        this.schedule(this.cut_schedule, 0.1);\r\n    },\r\n    //按钮被点击\r\n    on_button_click: function () {\r\n        this.sound_control.play_sound_effect(\"button_click\");\r\n        switch (this.button.state) {\r\n            case \"wait_cut\":\r\n                this.cut();\r\n                // console.log(\"hello 123 cutt\"); // harvesting\r\n                break;\r\n            case \"plant\":\r\n                var node = this.game_scene_js.create_plant_ui(this.game_scene_js.node);\r\n                if (node != null) {\r\n                    node.getComponent(\"plant_ui\").ini_node(this.land_index);\r\n                };\r\n                // console.log(\"hello plant\"); // choose plant \r\n                break;\r\n            case \"wait_till\":\r\n                user_data.user_data.land[this.land_index].land_state = \"wait_till\";\r\n                this.till();\r\n                // console.log(\"hello 123\");   // planting\r\n                break;\r\n            default:\r\n                return;\r\n        };\r\n    },\r\n    //浇水\r\n    watering: function () {\r\n        this.water_buff = 2;\r\n        this.water_progress_node.active = true;\r\n        var all_water = config.all_water_num;\r\n        var bar = this.water_progress_node.getComponent(cc.ProgressBar);\r\n        this.water_schedule = function () {\r\n            if (user_data.user_data.land[this.land_index].land_state == \"grow\") {\r\n                var water_num = user_data.user_data.land[this.land_index].water_num;\r\n                user_data.user_data.land[this.land_index].water_num -= 0.1 * (1 - user_data.user_data.skill[\"water_saving\"] / 100);\r\n                water_num = user_data.user_data.land[this.land_index].water_num;\r\n                if (user_data.user_data.land[this.land_index].have_water == 0) water_num = 0;\r\n                if (water_num <= 0) {\r\n                    this.unschedule(this.water_schedule);\r\n                    this.water_buff = 1;\r\n                    user_data.user_data.land[this.land_index].have_water = 0;\r\n                    user_data.user_data.land[this.land_index].water_num = 0;\r\n                    // user_data.user_data.land[this.land_index].have_water = 0;   // lưu trạng thái có nước hay k của ô đất\r\n                    // console.log(\"hello \" + user_data.user_data.land[this.land_index].have_water)\r\n                    return;\r\n                } else {\r\n                    if (user_data.user_data.land[this.land_index].have_water == 0) bar.progress = 0;\r\n                    else \r\n                    {\r\n                        user_data.user_data.land[this.land_index].have_water=1;\r\n                        bar.progress = water_num / all_water;\r\n                    }\r\n                };\r\n            } else {\r\n                this.unschedule(this.water_schedule);\r\n                return;\r\n            };\r\n        };\r\n        this.schedule(this.water_schedule, 0.1);\r\n    },\r\n    water_charge: function () {\r\n        if (this.water_state == null) {\r\n            this.unschedule(this.water_schedule);\r\n            this.water_state = \"charge\";\r\n            var all_water = config.all_water_num;\r\n            var bar = this.water_progress_node.getComponent(cc.ProgressBar);\r\n            user_data.user_data.land[this.land_index].have_water = 1;\r\n            var callback = function () {\r\n                var now_water = user_data.user_data.land[this.land_index].water_num\r\n                user_data.user_data.land[this.land_index].water_num += 1;\r\n\r\n                if (now_water >= all_water) {\r\n                    this.unschedule(callback);\r\n                    user_data.user_data.land[this.land_index].water_num = all_water;\r\n                    this.water_state = null;\r\n                    if (user_data.user_data.land[this.land_index].land_state == \"cut\") {\r\n                        //\r\n                    } else {\r\n                        this.watering();\r\n                    };\r\n                    return;\r\n                };\r\n                bar.progress = now_water / all_water;\r\n            };\r\n            this.schedule(callback, 0.1);\r\n        } else if (this.water_state == \"charge\") {\r\n            user_data.user_data.land[this.land_index].water_num += 10;\r\n        };\r\n    },\r\n    //初始化节点\r\n    ini_node: function (index) {\r\n        this.sound_control = cc.find(\"sound_control\").getComponent(\"sound_control\");\r\n        var have = user_data.user_data.land[index].have;\r\n        this.land_index = index;\r\n        this.plant_type = user_data.user_data.land[this.land_index].plant_type;\r\n        var land_state = user_data.user_data.land[this.land_index].land_state;\r\n        this.plant_index = 0; //植物索引\r\n        this.plant_count = 0; //生长编号\r\n        this.water_buff = 1;  // 初始化水buff\r\n        this.water_state = null;\r\n        this.plant_frame_arr = [\r\n            this.plant0_frame_arr,\r\n            this.plant1_frame_arr,\r\n            this.plant2_frame_arr,\r\n            this.plant3_frame_arr,\r\n            this.plant4_frame_arr,\r\n            this.plant5_frame_arr,\r\n            this.plant6_frame_arr,\r\n            this.plant7_frame_arr,\r\n        ];\r\n        switch (have) {\r\n            case 0:\r\n                this.tips_node.active = true;\r\n                this.node.getComponent(cc.Sprite).spriteFrame = this.land_frame_arr[0];\r\n                this.plant_node.active = false;\r\n                this.plant_progress_node.active = false;\r\n                this.water_progress_node.active = false;\r\n                break;\r\n            case 1:\r\n                //till state\r\n                this.tips_node.active = false;\r\n                switch (land_state) {\r\n                    case \"wait_till\":\r\n                        this.wait_next(\"wait_till\");\r\n                        this.plant_node.active = false;\r\n                        this.plant_progress_node.active = false;\r\n                        this.water_progress_node.active = true;\r\n                        this.node.getComponent(cc.Sprite).spriteFrame = this.land_frame_arr[0];\r\n                        // this.wait_next(\"wait_till\");\r\n                        break;\r\n                    case \"wait_plant\":\r\n                        this.node.getComponent(cc.Sprite).spriteFrame = this.land_frame_arr[1];\r\n                        this.plant_progress_node.active = true;\r\n                        this.water_progress_node.active = true;\r\n                        // var bar = this.water_progress_node.getComponent(cc.ProgressBar);\r\n                        // if (user_data.user_data.land[this.land_index].have_water == 0) bar.progress = 0;\r\n                        this.plant_progress_label.string = \"Waiting to be planted\";\r\n                        this.plant_node.active = false;\r\n                        this.wait_next(\"plant\");\r\n                        break;\r\n                    case \"wait_cut\":\r\n                        this.node.getComponent(cc.Sprite).spriteFrame = this.land_frame_arr[1];\r\n                        this.plant_node.active = true;\r\n                        this.plant_progress_node.active = true;\r\n                        this.water_progress_node.active = true;\r\n                        // var bar = this.water_progress_node.getComponent(cc.ProgressBar);\r\n                        // if (user_data.user_data.land[this.land_index].have_water == 0) bar.progress = 0;\r\n                        this.plant_progress_label.string = \"Waiting for harvest\";\r\n                        this.plant_progress_node.getComponent(cc.ProgressBar).progress = 1;\r\n                        for (var i = 0; i < this.plant_node.children.length; i++) {\r\n                            this.plant_node.children[i].getComponent(cc.Sprite).spriteFrame = this.plant_frame_arr[this.plant_type][3];\r\n                        };\r\n                        this.wait_next(\"wait_cut\");\r\n                        // console.log(land_state + \" hello\");\r\n                        break;\r\n                    // case \"tilling\":     // trạng thái chưa trồng cây\r\n                    //     this.till();\r\n                    default:\r\n                        this.set_plant();\r\n                        this.node.getComponent(cc.Sprite).spriteFrame = this.land_frame_arr[1];\r\n                        // cc.log(land_state);\r\n                        return;\r\n\r\n                };\r\n                break;\r\n        };\r\n\r\n    },\r\n    //耕地\r\n    till: function () {\r\n        //只允许触发一次\r\n        if (user_data.user_data.land[this.land_index].land_state !== \"tilling\") {\r\n            user_data.user_data.land[this.land_index].land_state = \"tilling\";\r\n            var land_state = user_data.user_data.land[this.land_index].land_state;\r\n            user_data.user_data.land[this.land_index].alive_stage = 0;\r\n            this.plant_index = 0;\r\n            this.plant_count = 0;\r\n            //停掉所有的计时器\r\n            this.unschedule(this.water_schedule);\r\n            this.unschedule(this.plant_grow_schedule);\r\n            this.unschedule(this.cut_schedule);\r\n            this.unschedule(this.plant_schedule);\r\n            this.plant_node.active = false;\r\n            this.button.active = false;\r\n            var till_time = config.till_time * (1 - user_data.user_data.skill[\"tool_improve\"] / 100);\r\n            var bar = this.plant_progress_node.getComponent(cc.ProgressBar);\r\n            var now_time = 0;\r\n            this.plant_progress_node.active = true;\r\n            this.water_progress_node.active = true;\r\n            this.node.getComponent(cc.Sprite).spriteFrame = this.land_frame_arr[0];\r\n            var callback = function () {\r\n                now_time += 0.1;\r\n                if (now_time >= till_time && land_state == \"tilling\") {\r\n                    //                    cc.log(\"till over\");\r\n                    this.unschedule(callback);\r\n                    this.node.getComponent(cc.Sprite).spriteFrame = this.land_frame_arr[1];\r\n                    this.plant_progress_label.string = \"Waiting to be planted\";\r\n                    this.wait_next(\"plant\");\r\n                } else {\r\n                    bar.progress = now_time / till_time;\r\n                    var progress_num = parseInt(bar.progress * 100);\r\n                    this.plant_progress_label.string = \"In the ground \" + progress_num + \"%\";\r\n                };\r\n            };\r\n            this.schedule(callback, 0.1);\r\n        } else {\r\n            return;\r\n        };\r\n    },\r\n    //种植\r\n    plant: function (plant_index) {\r\n        user_data.user_data.land[this.land_index].land_state = \"wait_plant\";\r\n        user_data.user_data.land[this.land_index].plant_type = plant_index;\r\n        this.plant_type = plant_index;\r\n        user_data.user_data.land[this.land_index].alive_stage = 0;\r\n        var now_time = 0;\r\n        var plant_time = config.plant[plant_index].plant_time * (1 - user_data.user_data.skill[\"tool_improve\"] / 100);\r\n        var bar = this.plant_progress_node.getComponent(cc.ProgressBar);\r\n        this.button.active = false;\r\n        this.plant_schedule = function () {\r\n            now_time += 0.1;\r\n            if (now_time >= plant_time) {\r\n                this.unschedule(this.plant_schedule);\r\n                this.set_plant();\r\n            } else {\r\n                bar.progress = now_time / plant_time;\r\n                var progress_num = parseInt(bar.progress * 100);\r\n                this.plant_progress_label.string = \"Planting \" + progress_num + \"%\";\r\n            };\r\n        };\r\n        this.schedule(this.plant_schedule, 0.1);\r\n    },\r\n    onLoad() {\r\n        this.game_scene_js = cc.find(\"UI_ROOT\").getComponent(\"game_scene\");\r\n    },\r\n\r\n    start() {\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}