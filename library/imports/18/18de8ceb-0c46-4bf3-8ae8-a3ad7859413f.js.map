{"version":3,"sources":["assets\\script\\ui\\pet_content.js"],"names":["config","require","user_data","cc","Class","Component","properties","name_label","Label","introduce_label","skill_introduce_label","progress","ProgressBar","cultrue_button_node","Node","button_frame_arr","SpriteFrame","pet_icon_arr","pet_sprite","Sprite","share_label","button_buy","label_cost","ini_node","index","game_rules_js","find","getComponent","game_scene_js","ad_control","sound_control","update_content","spriteFrame","string","pet","name","introduce","skill_introduce","cost","have","active","on_cultrue_button_click","play_sound_effect","share_count","share_max","manual_share","share_succes","video_succes","wx","callback","video_state","video_tag","have_ad","need_ad","create_pet_a","create_tips_ui","node","unschedule","schedule","buy_pet","type","type_buy","gold","create_pet","share_schedule","share_state","share_tag","ini_share","now_time","Date","getTime","create_time","stay_time","start"],"mappings":"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","sourceRoot":"/","sourcesContent":["var config = require(\"config\");\r\nvar user_data = require(\"user_data\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        name_label: cc.Label,\r\n        introduce_label: cc.Label,\r\n        skill_introduce_label: cc.Label,\r\n        progress: cc.ProgressBar,\r\n        cultrue_button_node: cc.Node,\r\n        button_frame_arr: [cc.SpriteFrame],\r\n        pet_icon_arr: [cc.SpriteFrame],\r\n        pet_sprite: cc.Sprite,\r\n        share_label: cc.Node,\r\n        button_buy: cc.Node,\r\n        label_cost: cc.Label,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    //初始化节点\r\n    ini_node(index) {\r\n        this.game_rules_js = cc.find(\"UI_ROOT\").getComponent(\"game_rules\");\r\n        this.game_scene_js = cc.find(\"UI_ROOT\").getComponent(\"game_scene\");\r\n        this.ad_control = cc.find(\"ad_control\").getComponent(\"ad_control\");\r\n        this.sound_control = cc.find(\"sound_control\").getComponent(\"sound_control\");\r\n        this.index = index;\r\n        this.update_content();\r\n    },\r\n\r\n    update_content() {\r\n        this.pet_sprite.spriteFrame = this.pet_icon_arr[this.index];\r\n        this.name_label.string = config.pet[this.index].name;\r\n        this.introduce_label.string = config.pet[this.index].introduce;\r\n        this.skill_introduce_label.string = config.pet[this.index].skill_introduce;\r\n        this.label_cost.string = config.pet[this.index].cost;\r\n        // else this.icon.getComponent(cc.Sprite).SpriteFrame = icon_arr[1];\r\n        // this.progress.progress = user_data.user_data.pet[this.index].have_ad / config.pet[this.index].need_ad;\r\n        if (user_data.user_data.pet[this.index].have == 1) this.button_buy.active = false;\r\n    },\r\n    //培养按钮被点击\r\n    on_cultrue_button_click() {\r\n        this.sound_control.play_sound_effect(\"button_click\");\r\n        // if (config.pet[this.index].get_type == \"ad\"){\r\n        //     this.ad_control.show_videoAd(\"cultrue_pet\");\r\n        //     this.video_succes();\r\n        // } else {\r\n        //分享获取\r\n        var share_count = user_data.user_data.pet[this.index].share_count;\r\n        var share_max = config.pet[this.index].share_max;\r\n        // if (share_count < share_max) {\r\n        //正常分享\r\n        this.ad_control.manual_share(\"pet\");\r\n        this.share_succes();\r\n        // } else {\r\n        //     //次数已满\r\n        //     this.game_scene_js.create_tips_ui(this.game_rules_js.node, \"share_max\");\r\n        // };\r\n        // };\r\n    },\r\n    //检测视频是否播放成功\r\n    video_succes: function () {\r\n        if (typeof (wx) != \"undefined\") {\r\n            var callback = function () {\r\n                if (this.ad_control.video_state == 1 && this.ad_control.video_tag == \"cultrue_pet\") {\r\n                    this.ad_control.video_tag = null;\r\n                    this.ad_control.video_state = 2;\r\n                    user_data.user_data.pet[this.index].have_ad++;\r\n                    if (user_data.user_data.pet[this.index].have_ad >= config.pet[this.index].need_ad) {\r\n                        user_data.user_data.pet[this.index].have = 1;\r\n                        this.game_rules_js.create_pet_a(this.index);\r\n                        this.game_scene_js.create_tips_ui(this.game_rules_js.node, \"cultrue_succes\");\r\n                    };\r\n                    this.update_content();\r\n                    this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"cultrue_pet_succes\");\r\n                    this.unschedule(callback);\r\n                } else {\r\n                    if (this.ad_control.video_tag == null && this.ad_control.video_state == 2) {\r\n                        this.unschedule(callback);\r\n                    };\r\n                };\r\n            };\r\n            this.schedule(callback, 0.1);\r\n        };\r\n    },\r\n    buy_pet: function () {\r\n        var type = config.pet[this.index].type_buy;\r\n        switch (type) {\r\n            case \"gold\":\r\n                if (user_data.user_data.gold >= config.pet[this.index].cost) {\r\n                    user_data.user_data.gold -= config.pet[this.index].cost;\r\n                    user_data.user_data.pet[this.index].have = 1;\r\n                    this.game_scene_js.create_pet(this.game_scene_js.node, this.index);\r\n                    this.button_buy.active = false;\r\n                    \r\n                }\r\n                else this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"no_money_gold\");\r\n                this.update_content();\r\n                break;\r\n            case \"diamond\": // chưa có diamond trong config \r\n            // if (user_data.user_data.diamond >= config.pet[this.index].cost) {\r\n            //     user_data.user_data.diamond -= config.pet[this.index].cost;\r\n            //     user_data.user_data.pet[this.index].have = 1;\r\n            //     this.game_scene_js.create_pet(this.game_scene_js.node, this.index);\r\n            //     this.button_buy.active = false;\r\n            // }\r\n            // else this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"no_money\");\r\n            // this.update_content();\r\n            // break;\r\n\r\n        }\r\n\r\n\r\n\r\n    },\r\n    //分享检测\r\n    share_succes() {\r\n        var share_schedule = function () {\r\n            if (this.ad_control.share_state == \"share_succes\" && this.ad_control.share_tag == \"pet\") {\r\n                this.ad_control.ini_share();\r\n                //宠物生成的时间\r\n                var now_time = new Date().getTime();\r\n                if ((now_time - user_data.user_data.pet[this.index].create_time) * 1000 >= config.pet[this.index].stay_time) {\r\n                    //宠物不存在\r\n                    user_data.user_data.pet[this.index].create_time = new Date().getTime();\r\n                    user_data.user_data.pet[this.index].have = 1;\r\n                    user_data.user_data.pet[this.index].share_count++;\r\n                    this.game_rules_js.create_pet_a(this.index);\r\n                    this.game_scene_js.create_tips_ui(this.game_rules_js.node, \"cultrue_succes\");\r\n                    this.update_content();\r\n                    this.unschedule(share_schedule);\r\n                } else {\r\n                    this.unschedule(share_schedule);\r\n                    this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"pet_already_life\");\r\n                };\r\n\r\n            } else {\r\n                //未分享停止检测\r\n                if (this.ad_control.share_state == \"un_share\" && this.ad_control.share_tag == null) {\r\n                    this.unschedule(share_schedule);\r\n                };\r\n            };\r\n        };\r\n        this.schedule(share_schedule, 0.2)\r\n    },\r\n\r\n    //onLoad() { },\r\n\r\n    start() {\r\n        this.update_content();\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}