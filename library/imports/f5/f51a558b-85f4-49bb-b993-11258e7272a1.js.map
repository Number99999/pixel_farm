{"version":3,"sources":["assets\\script\\ui\\rest_ui.js"],"names":["user_data","require","config","cc","Class","Component","properties","role_sprite","Sprite","role_arr","SpriteFrame","center_node","Node","ini_node","staff_index","ad_control","find","getComponent","game_scene_js","adsManager_js","sound_control","show_bannerAd","spriteFrame","scale","ini_anim","tween","to","easing","start","on_iwanna_button_click","log","play_sound_effect","show_videoAd","video_succes","on_touch_exit_click","e","node","destroy","on_keep_rest_button_click","showRewardedVideo","callback","staff","now_time","Date","getTime","over_time","rest_time","create_tips_ui","schedule","wx","video_state","video_tag","unschedule","hide_bannerAd","onLoad"],"mappings":"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","sourceRoot":"/","sourcesContent":["var user_data = require(\"user_data\");\nvar config = require(\"config\");\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        role_sprite: cc.Sprite,\n        role_arr: [cc.SpriteFrame],\n        center_node: cc.Node,\n    },\n    //初始化节点\n    ini_node(staff_index) {\n        this.ad_control = cc.find(\"ad_control\").getComponent(\"ad_control\");\n        this.game_scene_js = cc.find(\"UI_ROOT\").getComponent(\"game_scene\");\n        this.adsManager_js = cc.find(\"UI_ROOT\").getComponent(\"AdsManager\");\n        this.sound_control = cc.find(\"sound_control\").getComponent(\"sound_control\");\n        this.ad_control.show_bannerAd();\n        //初始小人的形象\n        this.staff_index = staff_index;\n        this.role_sprite.spriteFrame = this.role_arr[staff_index];\n        this.center_node.scale = 0;\n        this.ini_anim();\n    },\n    //初始化动画\n    ini_anim() {\n        cc.tween(this.center_node)\n            .to(0.3, { scale: 1 }, { easing: \"sineOut\" })\n            .start();\n    },\n    //i wanna button click\n    on_iwanna_button_click() {\n        cc.log(\"create_ad\");\n        this.sound_control.play_sound_effect(\"button_click\");\n        this.ad_control.show_videoAd(\"staff_rest\");\n        this.video_succes();\n    },\n    on_touch_exit_click(e) {\n        this.node.destroy();\n    },\n    //keep rest\n    on_keep_rest_button_click() {\n        // user_data.user_data.staff[this.staff_index].now_time = new Date().getTime() /1000;\n        // user_data.user_data.staff[this.staff_index].over_time -= config.staff[this.staff_index].rest_time;\n        // console.log(\"43 now time \" + user_data.user_data.staff[this.staff_index].now_time );\n        // console.log(\"44 rest time \" + config.staff[this.staff_index].rest_time );\n        // console.log(\"45 over time\" + user_data.user_data.staff[this.staff_index].over_time);\n        this.adsManager_js.showRewardedVideo(() => {\n            var callback = function () {\n                // this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"staff_rest_over\");\n                user_data.user_data.staff[this.staff_index].now_time = new Date().getTime() / 1000;\n                user_data.user_data.staff[this.staff_index].over_time -= config.staff[this.staff_index].rest_time;\n                this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"staff_rest_over\");\n                this.node.destroy();\n            };\n            this.schedule(callback, 0.2);\n        });\n    },\n\n    //检测视频是否播放成功\n    video_succes: function () {\n        if (typeof (wx) != \"undefined\") {\n            var callback = function () {\n                if (this.ad_control.video_state == 1 && this.ad_control.video_tag == \"staff_rest\") {\n                    this.ad_control.video_tag = null;\n                    this.ad_control.video_state = 2;\n                    user_data.user_data.staff[this.staff_index].over_time = 0;\n                    this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"staff_rest_over\");\n                    this.unschedule(callback);\n                    this.ad_control.hide_bannerAd();\n                    this.node.destroy();\n                } else {\n                    if (this.ad_control.video_tag == null && this.ad_control.video_state == 2) {\n                        this.unschedule(callback);\n                    };\n                };\n            };\n            this.schedule(callback, 0.2);\n        };\n    },\n    onLoad() { },\n\n    start() {\n\n    },\n\n    // update (dt) {},\n});\n"]}