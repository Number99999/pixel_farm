{"version":3,"sources":["assets\\script\\ai\\player_role.js"],"names":["cc","Class","Component","properties","player_node","Node","gift_node","gift_frame_arr","SpriteFrame","change_movement_direction","callback","stop_move","num","Math","floor","random","all_direction","length","movement_direction","anim_select","schedule","anim","getComponent","Animation","anim_clips","getClips","log","play","name","node","scaleX","ai_move","dt","s","move_speed","x","y","on_gift_button_click","sound_control","play_sound_effect","random_ex","gift_type","i","game_scene_js","create_ex_effect","active","create_gift_ui","ini_node","find","create_gift","random_num","Sprite","spriteFrame","hide_gift","scheduleOnce","onLoad","start","update"],"mappings":"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","sourceRoot":"/","sourcesContent":["cc.Class({\n    extends: cc.Component,\n\n    properties: {\n        player_node: cc.Node,\n        gift_node: cc.Node,\n        gift_frame_arr: [cc.SpriteFrame],\n    },\n\n    // LIFE-CYCLE CALLBACKS:\n    // 每隔几秒改变移动方向\n    change_movement_direction: function () {\n        var callback = function () {\n            this.stop_move = false;\n            var num = Math.floor(Math.random() * this.all_direction.length - 1) + 1;\n            if (num < 0) {\n                num = 0;\n            };\n            this.movement_direction = this.all_direction[num];\n            this.anim_select();\n        };\n        this.schedule(callback, Math.random() * 3 + 2);\n    },\n    //anim select\n    anim_select: function () {\n        var anim = this.player_node.getComponent(cc.Animation);\n        var anim_clips = anim.getClips();//获取动画剪辑\n        cc.log(\"this.movement_direction: \", this.movement_direction);\n        switch (this.movement_direction) {\n            case \"z_idle\":\n                anim.play(anim_clips[0].name);\n                break;\n            case \"z_run\":\n                anim.play(anim_clips[1].name);\n                break;\n            case \"b_idle\":\n                anim.play(anim_clips[2].name);\n                break;\n            case \"b_run\":\n                anim.play(anim_clips[3].name);\n                break;\n            case \"c_idle\":\n                anim.play(anim_clips[4].name);\n                break;\n            case \"c_run_l\":\n                this.node.scaleX = 1;\n                anim.play(anim_clips[5].name);\n                break;\n            case \"c_run_r\":\n                this.node.scaleX = -1;\n                anim.play(anim_clips[5].name);\n                break;\n        };\n    },\n    //随机某个方向移动\n    ai_move: function (dt) { //dt游戏时间\n\n        //得到每帧的速度\n        var s = this.move_speed * dt;\n        //\n        if (this.node.x <= -65 && this.stop_move == false) {\n            this.stop_move = true;\n            this.movement_direction = \"c_run_r\";\n            this.anim_select();\n        }\n        if (this.node.x >= 65 && this.stop_move == false) {\n            this.stop_move = true;\n            this.movement_direction = \"c_run_l\";\n            this.anim_select();\n\n        }\n        if (this.node.y >= 290 && this.stop_move == false) {\n            this.stop_move = true;\n            this.movement_direction = \"z_run\";\n            this.anim_select();\n\n        }\n        if (this.node.y <= -529 && this.stop_move == false) {\n            this.stop_move = true;\n            this.movement_direction = \"b_run\";\n            this.anim_select();\n        }\n\n        //几种不同的移动策略\n        switch (this.movement_direction) {\n            case \"z_idle\":\n                s = 0;\n                break;\n            case \"z_run\":\n                this.node.y -= s;\n                break;\n            case \"b_idle\":\n                s = 0;\n                break;\n            case \"b_run\":\n                this.node.y += s;\n                break;\n            case \"c_idle\":\n                s = 0;\n                break;\n            case \"c_run_l\":\n                this.node.x -= s;\n                break;\n            case \"c_run_r\":\n                this.node.x += s;\n                break;\n        };\n\n    },\n    //按钮被点击\n    on_gift_button_click() {\n        this.sound_control.play_sound_effect(\"button_click\");\n        var random_ex = Math.floor(Math.random() * 10) + 1;\n        //最大值为6\n        if(random_ex >6){\n            random_ex = 6;\n        };\n        switch (this.gift_type) {\n            case \"ex\":\n                for (var i = 0; i < random_ex; i++) {\n                    this.game_scene_js.create_ex_effect(this.gift_node, i);\n                };\n                this.gift_type = null;\n                this.gift_node.active = false;\n                break;\n            case \"ad\":\n                this.gift_type = null;\n                this.gift_node.active = false;\n                this.game_scene_js.create_gift_ui(this.game_scene_js.node);\n                break;\n        };\n    },\n    ini_node: function () {\n        this.game_scene_js = cc.find(\"UI_ROOT\").getComponent(\"game_scene\");\n        this.sound_control = cc.find(\"sound_control\").getComponent(\"sound_control\");\n        this.all_direction = [\"z_idle\", \"z_run\", \"b_idle\", \"b_run\", \"c_idle\", \"c_run_l\", \"c_run_r\"];\n        this.movement_direction = \"z_idle\";\n        //小人的移动速度\n        this.move_speed = 30;\n        this.gift_node.active = false;\n        this.gift_type = null;\n        //停止移动，边缘时触发\n        this.stop_move = false;\n        this.create_gift();\n    },\n    //生成礼物\n    create_gift() {\n        var callback = function () {\n            var random_num = Math.random();\n            if (random_num > 0.5) {\n                this.gift_type = \"ex\";\n                this.gift_node.active = true;\n                this.gift_node.getComponent(cc.Sprite).spriteFrame = this.gift_frame_arr[0];\n            } else {\n                this.gift_type = \"ad\";\n                this.gift_node.active = true;\n                this.gift_node.getComponent(cc.Sprite).spriteFrame = this.gift_frame_arr[1];\n\n            };\n            this.hide_gift();\n        };\n        this.schedule(callback, 30);\n    },\n    //隐藏礼物\n    hide_gift() {\n        //10s后隐藏礼物\n        var callback = function () {\n            this.gift_node.active = false;\n            this.gift_type = null;\n        };\n        this.scheduleOnce(callback, 10);\n    },\n    onLoad() {\n        this.ini_node();\n    },\n\n    start() {\n        this.change_movement_direction();\n        this.anim_select();\n    },\n\n    update(dt) {\n        this.ai_move(dt);\n    },\n});"]}