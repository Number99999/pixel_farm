{"version":3,"sources":["assets\\script\\ui\\gift_ui.js"],"names":["user_data","require","cc","Class","Component","properties","center_node","Node","exit_button_node","introduce_label","Label","ini_node","ad_control","find","getComponent","adsManager_js","game_scene_js","game_rules_js","sound_control","show_bannerAd","scale","active","level","string","tween","to","easing","call","scheduleOnce","start","on_i_wanner_ad_button_click","play_sound_effect","showRewardedVideo","add_ex","create_tips_ui","node","now_ex","skill_point","set_ex_progress","hide_bannerAd","unschedule","callback","destroy","on_exit_button_click","video_succes","wx","video_state","video_tag","schedule"],"mappings":"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","sourceRoot":"/","sourcesContent":["var user_data = require(\"user_data\");\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        center_node: cc.Node,\r\n        exit_button_node: cc.Node,\r\n        introduce_label: cc.Label,\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    ini_node() {\r\n        this.ad_control = cc.find(\"ad_control\").getComponent(\"ad_control\");\r\n        this.adsManager_js = cc.find(\"UI_ROOT\").getComponent(\"AdsManager\");\r\n        this.game_scene_js = cc.find(\"UI_ROOT\").getComponent(\"game_scene\");\r\n        this.game_rules_js = cc.find(\"UI_ROOT\").getComponent(\"game_rules\");\r\n        this.sound_control = cc.find(\"sound_control\").getComponent(\"sound_control\");\r\n        this.ad_control.show_bannerAd();\r\n        this.center_node.scale = 0;\r\n        this.exit_button_node.active = false;\r\n        if (user_data.user_data.level < 15) {\r\n            this.introduce_label.string = \"Watch short commercials, \\nlevel+1\";\r\n        } else {\r\n            this.introduce_label.string = \"Watch short commercials and \\ngain half-level experience\";\r\n        };\r\n        cc.tween(this.center_node)\r\n            .to(0.3, { scale: 1 }, { easing: \"elasticOut\" })\r\n            .call(() => {\r\n                this.scheduleOnce(() => {\r\n                    this.exit_button_node.active = true;\r\n                }, 1.5)\r\n            })\r\n            .start();\r\n    },\r\n    //我要看视频按钮被点击\r\n    on_i_wanner_ad_button_click() {\r\n        this.sound_control.play_sound_effect(\"button_click\");\r\n        this.adsManager_js.showRewardedVideo(() => {\r\n            if (user_data.user_data.level > 15) {\r\n                this.game_rules_js.add_ex(user_data.user_data.level);\r\n                this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"gift_ad_ex\");\r\n            } else {\r\n                user_data.user_data.level++;\r\n                user_data.user_data.now_ex = 0;\r\n                user_data.user_data.skill_point++;\r\n                this.game_rules_js.set_ex_progress();\r\n                this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"gift_ad_level\");\r\n            };\r\n            this.ad_control.hide_bannerAd();\r\n            this.unschedule(callback);\r\n            this.node.destroy();\r\n        });\r\n    },\r\n    //exit button\r\n    on_exit_button_click() {\r\n        this.sound_control.play_sound_effect(\"button_exit\");\r\n        this.ad_control.hide_bannerAd();\r\n        this.node.destroy();\r\n    },\r\n    //检测视频是否播放成功\r\n    video_succes: function () {\r\n        if (typeof (wx) != \"undefined\") {\r\n            var callback = function () {\r\n                if (this.ad_control.video_state == 1 && this.ad_control.video_tag == \"gift_ad\") {\r\n                    this.ad_control.video_tag = null;\r\n                    this.ad_control.video_state = 2;\r\n                    if (user_data.user_data.level > 15) {\r\n                        this.game_rules_js.add_ex(user_data.user_data.level);\r\n                        this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"gift_ad_ex\");\r\n                    } else {\r\n                        user_data.user_data.level++;\r\n                        user_data.user_data.now_ex = 0;\r\n                        user_data.user_data.skill_point++;\r\n                        this.game_rules_js.set_ex_progress();\r\n                        this.game_scene_js.create_tips_ui(this.game_scene_js.node, \"gift_ad_level\");\r\n                    };\r\n                    this.ad_control.hide_bannerAd();\r\n                    this.unschedule(callback);\r\n                    this.node.destroy();\r\n                } else {\r\n                    if (this.ad_control.video_tag == null && this.ad_control.video_state == 2) {\r\n                        this.unschedule(callback);\r\n                    };\r\n                };\r\n            };\r\n            this.schedule(callback, 0.2);\r\n        };\r\n    },\r\n    // onLoad () {},\r\n\r\n    start() {\r\n\r\n    },\r\n\r\n    // update (dt) {},\r\n});\r\n"]}